import{a as p,u as v,j as e,c as b,r as n,b as E,H as V,L as H}from"./app-DGZpcoEf.js";import{u as $}from"./useTranslation-B70rtC_o.js";import{A as Y}from"./AuthenticatedLayout-QvHA3J9k.js";import{T as I}from"./TextInput-Dtb4ArT_.js";import{I as N}from"./InputLabel-DPaDfknu.js";import{I as _}from"./InputError-BL3f_Rmu.js";import{M as B}from"./Modal-CaaODvU6.js";import{T as W}from"./triangle-alert-jcw7F4DP.js";import{C as G,H as z,P as Q}from"./PaymentModal-DpH-NCud.js";import{e as C,S as Z,M as X,a as g,R as S,X as P,P as J}from"./Header-BmoeIyjT.js";import{c as D}from"./createLucideIcon-Jm3AEVgt.js";import{S as K}from"./send-U1ov25GA.js";import{L as ee}from"./lock-CwqiprT_.js";import{C as w}from"./circle-check-big-BrgJLQDx.js";import{C as M}from"./clock-D9NFEChb.js";import{C as te}from"./circle-dollar-sign-CUqofgiq.js";import{C as se}from"./calendar-CuGAQ-oE.js";import{U as ae}from"./user-CCur7lLM.js";import{C as L}from"./circle-alert-BVcCTWxK.js";import{P as re}from"./pen-line-Did2Raln.js";import{C as le}from"./credit-card-CMMOY2Ih.js";import{H as A}from"./hammer-DMJRuT7P.js";import{R as F}from"./rocket-D8gTntlO.js";import{T as O}from"./tag-aPZp1jmZ.js";import{B as oe}from"./briefcase-Dj9NkFCF.js";import{Z as ce}from"./zap-BpTSWDMP.js";import"./Footer-B6M1zDSw.js";import"./transition-x_x8a0JL.js";import"./with-selector-pZowTde5.js";import"./PrimaryButton-giitCT6x.js";import"./SecondaryButton-CLZzXx2Z.js";import"./circle-user-B8B-okVQ.js";const ne=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],R=D("image",ne);const ie=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],T=D("map",ie);function de({missionId:t,t:l}){const[s,o]=p.useState(!1),{data:i,setData:c,post:d,processing:x,reset:u}=v({reason:""}),f=m=>{m.preventDefault(),d(route("missions.dispute",t),{onSuccess:()=>{u(),o(!1)}})};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>o(!0),className:"py-5 bg-red-600 text-white font-black rounded-full hover:bg-red-700 transition-all shadow-xl text-lg flex items-center justify-center gap-2",children:[e.jsx(W,{size:20})," ",l("Open Dispute")]}),e.jsx(B,{show:s,onClose:()=>o(!1),maxWidth:"2xl",children:e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-black text-oflem-charcoal mb-4",children:"Open a Dispute"}),e.jsx("p",{className:"text-sm text-gray-muted font-medium mb-6",children:"Please explain why you're not satisfied with the work. An admin will review your case."}),e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"reason",value:"Reason for Dispute",className:"text-xs uppercase tracking-widest font-black mb-3"}),e.jsx("textarea",{id:"reason",className:"w-full bg-oflem-cream border-gray-border rounded-[24px] p-5 text-sm font-medium focus:border-oflem-terracotta focus:ring-0 min-h-[150px]",placeholder:"Describe the issue in detail...",value:i.reason,onChange:m=>c("reason",m.target.value),required:!0})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 py-3 bg-gray-200 text-oflem-charcoal font-black rounded-full hover:bg-gray-300 transition-all",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:x,className:"flex-1 py-3 bg-red-600 text-white font-black rounded-full hover:bg-red-700 transition-all disabled:opacity-50",children:"Submit Dispute"})]})]})]})})]})}function me({provider:t,t:l}){return e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-80 bg-white rounded-[24px] p-6 shadow-2xl border-2 border-oflem-terracotta z-50 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4 pb-4 border-b border-gray-border",children:[e.jsx("img",{src:t.profile_photo_url||t.avatar||"/images/avatars/default-avatar.svg",alt:t.name,className:"w-16 h-16 rounded-full object-cover border-3 border-oflem-terracotta shadow-lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-black text-lg text-oflem-charcoal mb-1",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-muted font-medium",children:["@",t.username||"user"]}),e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[[...Array(5)].map((s,o)=>e.jsx("span",{className:`text-sm ${o<Math.round(parseFloat(t.rating_cache||0))?"text-oflem-terracotta":"text-gray-300"}`,children:e.jsx(C,{size:14,className:`${o<Math.round(parseFloat(t.rating_cache||0))?"text-oflem-terracotta fill-oflem-terracotta":"text-gray-300"}`})},o)),e.jsxs("span",{className:"text-xs font-bold text-gray-muted ml-1",children:["(",t.reviews_count_cache||0,")"]})]})]})]}),t.matched_skills&&t.matched_skills.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-muted uppercase tracking-wider mb-2",children:l("Matched Skills")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.matched_skills.slice(0,3).map((s,o)=>e.jsx("span",{className:"px-3 py-1 bg-gradient-to-br from-oflem-terracotta to-oflem-terracotta-light/10 text-oflem-terracotta text-xs font-bold rounded-full",children:s},o))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[t.provider_profile?.years_experience&&e.jsxs("div",{className:"bg-oflem-cream rounded-[16px] p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-oflem-charcoal",children:t.provider_profile.years_experience}),e.jsx("p",{className:"text-[9px] font-black text-gray-muted uppercase tracking-wider",children:l("Years Exp")})]}),t.distance_km&&e.jsxs("div",{className:"bg-oflem-cream rounded-[16px] p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-oflem-charcoal",children:t.distance_km}),e.jsx("p",{className:"text-[9px] font-black text-gray-muted uppercase tracking-wider",children:l("km away")})]})]}),t.provider_profile?.bio&&e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:"text-xs text-gray-muted font-medium line-clamp-3",children:t.provider_profile.bio})})]})}function xe({mission:t,t:l}){const[s,o]=p.useState([]),[i,c]=p.useState(!0),[d,x]=p.useState(null),[u,f]=p.useState(null);p.useEffect(()=>{b.get(route("missions.nearby-providers",t.id)).then(r=>{o(r.data.nearby_providers),c(!1)}).catch(r=>{console.error("Error fetching nearby Providers:",r),c(!1)})},[t.id]);const m=r=>{x(r),n.post(route("missions.send-to-provider",{mission:t.id,provider:r}),{},{onFinish:()=>x(null)})};return i?e.jsx("section",{className:"bg-white rounded-[40px] p-8 shadow-sm border border-gray-border",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-oflem-terracotta border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"mt-4 text-sm font-bold text-gray-muted",children:l("Finding nearby helpers...")})]})}):s.length===0?e.jsxs("section",{className:"bg-white rounded-[40px] p-8 shadow-sm border border-gray-border",children:[e.jsxs("h2",{className:"text-2xl font-black text-oflem-charcoal mb-6 flex items-center gap-3",children:[e.jsx(T,{size:24,className:"text-oflem-terracotta"})," ",l("Nearby Helpers")]}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-zinc-50 rounded-3xl flex items-center justify-center mx-auto mb-4 text-zinc-300",children:e.jsx(Z,{size:40})}),e.jsx("p",{className:"text-gray-muted font-bold",children:l("No helpers found nearby")}),e.jsx("p",{className:"text-xs text-gray-muted mt-2",children:l("Try expanding your search radius or wait for offers")})]})]}):e.jsxs("section",{className:"bg-white rounded-[40px] p-8 shadow-sm border border-gray-border",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-2xl font-black text-oflem-charcoal mb-2 flex items-center gap-3",children:[e.jsx(T,{size:24,className:"text-oflem-terracotta"})," ",l("Nearby Helpers")]}),e.jsxs("p",{className:"text-sm text-gray-muted font-medium",children:[l("Found")," ",s.length," ",l("helpers near your mission location")]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(r=>e.jsxs("div",{className:"relative group",onMouseEnter:()=>f(r),onMouseLeave:()=>f(null),children:[e.jsxs("div",{className:"bg-oflem-cream rounded-[24px] p-5 border-2 border-transparent hover:border-oflem-terracotta transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("img",{src:r.profile_photo_url||r.avatar||"/images/avatars/default-avatar.svg",alt:r.name,className:"w-12 h-12 rounded-full object-cover border-2 border-white shadow-md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-black text-oflem-charcoal truncate",children:r.name}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(C,{size:14,fill:"currentColor",className:"text-oflem-terracotta"}),e.jsx("span",{className:"text-xs font-bold text-gray-muted",children:parseFloat(r.rating_cache||0).toFixed(1)}),r.distance_km&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-300 mx-1",children:"â€¢"}),e.jsxs("span",{className:"text-xs font-bold text-gray-muted",children:[r.distance_km," km"]})]})]})]})]}),r.match_score>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-muted uppercase tracking-wider",children:l("Match Score")}),e.jsxs("span",{className:"text-xs font-black text-oflem-charcoal",children:[r.match_score,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-oflem-terracotta to-[#D4AF37] rounded-full",style:{width:`${Math.min(r.match_score,100)}%`}})})]}),e.jsx("button",{onClick:()=>m(r.id),disabled:d===r.id,className:"w-full py-3 bg-oflem-charcoal text-white font-black rounded-full hover:bg-black transition-all text-sm disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:d===r.id?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),l("Sending...")]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{size:16})," ",l("Send to Provider")]})})]}),u?.id===r.id&&e.jsx(me,{provider:r,t:l})]},r.id))})]})}function We({mission:t,canSeeAddress:l}){const{t:s}=$(),{auth:o,flash:i}=E().props,c=Number(o.user.id)===Number(t.user_id),d=Number(o.user.id)===Number(t.assigned_user_id),[x,u]=p.useState(i?.stripe_client_secret||E().props.stripe_client_secret||null),[f,m]=p.useState(!!x);p.useEffect(()=>{i?.stripe_client_secret&&(u(i.stripe_client_secret),m(!0))},[i]),p.useEffect(()=>{if(i?.chat_id&&!i?.stripe_client_secret){const a=setTimeout(()=>{n.visit(route("messages",{chat_id:i.chat_id}))},1e3);return()=>clearTimeout(a)}},[i?.chat_id,i?.stripe_client_secret]),p.useEffect(()=>(window.Echo.private(`mission.${t.id}`).listen("QuestionPosted",a=>{n.reload({only:["mission"]})}).listen("AnswerPosted",a=>{n.reload({only:["mission"]})}).listen("MissionStatusUpdated",a=>{n.reload({only:["mission"]})}),()=>{window.Echo.leave(`mission.${t.id}`)}),[t.id]);const r=v({amount:"",message:""}),h=v({question:""}),y=a=>{a.preventDefault(),r.post(route("missions.submit-offer",t.id),{preserveScroll:!0,onSuccess:j=>{r.reset(),j.props.flash?.stripe_client_secret&&(u(j.props.flash.stripe_client_secret),m(!0))}})},U=a=>{a.preventDefault(),h.post(route("missions.ask-question",t.id),{preserveScroll:!0,onSuccess:()=>h.reset()})},q=()=>{n.post(route("missions.accept",t.id),{},{onSuccess:a=>{a.props.flash?.stripe_client_secret&&(u(a.props.flash.stripe_client_secret),m(!0))}})};return e.jsxs(Y,{header:t.title,maxWidth:"max-w-6xl",showFooter:!0,children:[e.jsx(V,{title:`${t.title} - Oflem`}),e.jsxs("div",{className:"py-16 px-6",children:[e.jsxs("div",{className:"grid lg:grid-cols-3 gap-12",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs("section",{className:"bg-white rounded-[40px] p-8 md:p-12 shadow-sm border border-gray-border",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-8",children:[e.jsx("span",{className:"px-4 py-1.5 bg-cream-accent text-oflem-charcoal text-[10px] font-black uppercase tracking-widest rounded-full",children:s(t.category||"General")}),t.status==="OUVERTE"?e.jsxs("span",{className:"flex items-center gap-1.5 px-4 py-1.5 bg-green-100 text-green-700 text-[10px] font-black uppercase tracking-widest rounded-full",children:[e.jsx(G,{size:10,fill:"currentColor"})," ",s("Open")]}):t.status==="EN_NEGOCIATION"?e.jsxs("span",{className:"flex items-center gap-1.5 px-4 py-1.5 bg-blue-100 text-blue-700 text-[10px] font-black uppercase tracking-widest rounded-full",children:[t.assigned_user_id?e.jsx(ee,{size:10}):e.jsx(z,{size:12}),t.assigned_user_id?s("Reserved"):s("In Negotiation")]}):t.status==="VERROUILLEE"?e.jsxs("span",{className:"flex items-center gap-1.5 px-4 py-1.5 bg-gradient-to-br from-oflem-terracotta to-oflem-terracotta-light text-white text-[10px] font-black uppercase tracking-widest rounded-full shadow-sm",children:[e.jsx(w,{size:10})," ",s("Assigned")]}):t.status==="EN_COURS"?e.jsxs("span",{className:"flex items-center gap-1.5 px-4 py-1.5 bg-yellow-400/20 text-yellow-700 text-[10px] font-black uppercase tracking-widest rounded-full",children:[e.jsx(M,{size:10})," ",s("In Progress")]}):t.status==="EN_VALIDATION"?e.jsxs("span",{className:"flex items-center gap-1.5 px-4 py-1.5 bg-orange-100 text-orange-700 text-[10px] font-black uppercase tracking-widest rounded-full",children:[e.jsx(w,{size:10})," ",s("In Validation")]}):e.jsx("span",{className:"px-4 py-1.5 bg-gray-100 text-gray-700 text-[10px] font-black uppercase tracking-widest rounded-full",children:s(t.status)})]}),e.jsx("h1",{className:"text-4xl font-black text-oflem-charcoal mb-6",children:t.title}),e.jsx("div",{className:"prose prose-sm max-w-none text-gray-muted font-medium mb-12 leading-relaxed",children:(t.description||"").split(`
`).map((a,j)=>e.jsx("p",{className:"mb-4",children:a},j))}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 pt-8 border-t border-gray-border",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(k,{icon:e.jsx(te,{size:20,className:"text-oflem-terracotta"}),label:s("Budget"),value:t.budget?`CHF ${t.budget}`:s("Open for offers")}),e.jsx(k,{icon:e.jsx(se,{size:20,className:"text-oflem-terracotta"}),label:s("Requested Date"),value:t.date_time?new Date(t.date_time).toLocaleString():s("Flexible")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(k,{icon:e.jsx(X,{size:20,className:"text-oflem-terracotta"}),label:s("Location"),value:l?t.exact_address||t.location:t.location||s("Approximate location"),subValue:!l&&s("Exact address revealed after assignment")}),e.jsx(k,{icon:e.jsx(ae,{size:20,className:"text-oflem-terracotta"}),label:s("Posted by"),value:t.user.name})]})]})]}),e.jsxs("section",{className:"bg-white rounded-[40px] p-8 md:p-12 shadow-sm border border-gray-border",children:[e.jsxs("h2",{className:"text-2xl font-black text-oflem-charcoal mb-8 flex items-center gap-3",children:[e.jsx(g,{className:"text-oflem-terracotta",size:28})," ",s("Questions & Answers")]}),e.jsx("div",{className:"space-y-8 mb-10",children:t.questions.length>0?t.questions.map(a=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-11 h-11 rounded-2xl bg-oflem-terracotta text-white flex items-center justify-center font-black shadow-sm",children:a.user.name.charAt(0)}),e.jsxs("div",{className:"elegant-capsule !bg-oflem-cream/30 !p-6 flex-1 !border-oflem-terracotta/5",children:[e.jsx("p",{className:"text-sm font-black text-oflem-charcoal mb-1.5",children:a.user.name}),e.jsx("p",{className:"text-sm text-gray-muted font-medium leading-relaxed",children:a.question})]})]}),a.answer?e.jsxs("div",{className:"flex gap-4 ml-12",children:[e.jsx("div",{className:"flex-shrink-0 w-11 h-11 rounded-2xl bg-oflem-charcoal text-white flex items-center justify-center font-black shadow-sm",children:t.user.name.charAt(0)}),e.jsxs("div",{className:"elegant-capsule !bg-cream-accent/40 !p-6 flex-1 !border-oflem-terracotta/10",children:[e.jsxs("p",{className:"text-sm font-black text-oflem-charcoal mb-1.5",children:[t.user.name," ",e.jsx("span",{className:"text-[10px] uppercase text-oflem-terracotta ml-2 font-black tracking-widest",children:s("Creator")})]}),e.jsx("p",{className:"text-sm text-gray-muted font-medium leading-relaxed",children:a.answer})]})]}):c&&e.jsx(fe,{missionId:t.id,questionId:a.id,t:s})]},a.id)):e.jsx("p",{className:"text-gray-muted font-bold text-center py-4",children:s("No questions yet.")})}),!c&&t.status==="OUVERTE"&&e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsx(N,{htmlFor:"question",value:s("Ask a question"),className:"text-xs uppercase tracking-widest font-black"}),e.jsx("textarea",{id:"question",className:"w-full bg-oflem-cream border-gray-border rounded-[24px] p-5 text-sm font-medium focus:border-oflem-terracotta focus:ring-0 min-h-[100px]",placeholder:s("Ask for more details about the mission..."),value:h.data.question,onChange:a=>h.setData("question",a.target.value),required:!0}),e.jsx("button",{type:"submit",disabled:h.processing,className:"px-8 py-3 bg-oflem-charcoal text-white font-black rounded-full hover:bg-black transition-all text-sm disabled:opacity-50",children:s("Post Question")})]})]}),t.status==="EN_VALIDATION"&&c&&e.jsxs("section",{className:"elegant-capsule !bg-oflem-terracotta/5 !p-8 md:!p-12 !rounded-[40px] border-oflem-terracotta/20",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-sm text-oflem-terracotta",children:e.jsx(M,{size:32})}),e.jsx("h2",{className:"text-3xl font-black text-oflem-charcoal mb-2",children:s("Validation Required")}),e.jsx("p",{className:"text-sm text-gray-muted font-bold",children:"The provider has submitted their work. Please review and validate or dispute."})]}),t.completion_proof_path&&e.jsxs("div",{className:"mb-8 bg-white rounded-[24px] p-6 text-left",children:[e.jsxs("h3",{className:"text-lg font-black text-oflem-charcoal mb-4 flex items-center gap-3",children:[e.jsx(R,{className:"text-oflem-terracotta",size:20})," ",s("Proof of Completion")]}),e.jsx("img",{src:`/storage/${t.completion_proof_path}`,alt:"Completion Proof",className:"w-full rounded-[16px] mb-4 shadow-md"}),t.completion_notes&&e.jsxs("div",{className:"bg-oflem-cream rounded-[16px] p-4",children:[e.jsx("p",{className:"text-xs font-black text-gray-muted uppercase tracking-widest mb-2",children:"Notes from Provider"}),e.jsx("p",{className:"text-sm text-oflem-charcoal font-medium",children:t.completion_notes})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>{confirm("Are you sure you want to validate this mission? Payment will be released to the provider.")&&n.post(route("missions.validate",t.id))},className:"py-5 bg-green-600 text-white font-black rounded-full hover:bg-green-700 transition-all shadow-xl text-lg flex items-center justify-center gap-3 group",children:[e.jsx(w,{size:24,className:"group-hover:scale-110 transition-transform"})," ",s("Validate & Release Payment")]}),e.jsx(de,{missionId:t.id,t:s})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:async()=>{const a=await b.get(route("api.missions.chat",t.id));n.visit(route("messages",{chat_id:a.data.id}))},className:"w-full py-4 bg-oflem-charcoal text-white font-black rounded-full hover:bg-oflem-charcoal transition-all flex items-center justify-center gap-2",children:[e.jsx(g,{size:18,className:"inline"})," ",s("Message Provider")]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-xs text-gray-muted font-bold",children:[e.jsx(L,{size:14,className:"inline mr-1"})," Auto-validates in 72 hours if no action is taken"]})})]}),t.status==="EN_COURS"&&d&&e.jsxs("section",{className:"elegant-capsule !bg-oflem-cream/50 !p-8 md:!p-12 !rounded-[40px] border-zinc-200",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-sm text-oflem-terracotta",children:e.jsx(R,{size:32})}),e.jsx("h2",{className:"text-3xl font-black text-oflem-charcoal mb-2",children:s("Submit Proof of Completion")}),e.jsx("p",{className:"text-sm text-gray-muted font-bold",children:"Upload a photo and notes to show the client you've completed the mission."})]}),e.jsx(ue,{missionId:t.id,t:s})]}),t.status==="EN_VALIDATION"&&d&&e.jsx("section",{className:"elegant-capsule !bg-oflem-cream/50 !p-8 md:!p-12 !rounded-[40px] border-zinc-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-sm text-oflem-terracotta",children:e.jsx(S,{size:32,className:"animate-spin-slow"})}),e.jsx("h2",{className:"text-3xl font-black text-oflem-charcoal mb-2",children:s("Awaiting Validation")}),e.jsx("p",{className:"text-sm text-gray-muted font-bold mb-6",children:"The client is reviewing your work. You'll be notified once they validate."}),t.completion_proof_path&&e.jsxs("div",{className:"bg-white rounded-[24px] p-6 text-left",children:[e.jsx("h3",{className:"text-lg font-black text-oflem-charcoal mb-4",children:"Your Submission"}),e.jsx("img",{src:`/storage/${t.completion_proof_path}`,alt:"Your Proof",className:"w-full rounded-[16px] mb-4 shadow-md"}),t.completion_notes&&e.jsxs("p",{className:"text-sm text-gray-muted font-medium italic",children:['"',t.completion_notes,'"']})]})]})})]}),e.jsx("div",{className:"space-y-8",children:e.jsxs("section",{className:"bg-white rounded-[40px] p-8 shadow-sm border border-gray-border sticky top-8",children:[c&&t.status==="OUVERTE"&&e.jsxs("div",{className:"space-y-4 mb-6 pb-6 border-b border-gray-border",children:[e.jsxs(H,{href:route("missions.edit",t.id),className:"w-full py-4 bg-gradient-to-br from-oflem-terracotta to-oflem-terracotta-light text-white font-black rounded-full hover:opacity-90 transition-all shadow-xl flex items-center justify-center gap-3 group",children:[e.jsx(re,{size:18,className:"group-hover:rotate-12 transition-transform"})," ",s("Edit Mission")]}),e.jsxs("button",{onClick:()=>{confirm(s("Are you sure you want to cancel this mission?"))&&n.post(route("missions.update-status",t.id),{status:"ANNULEE"})},className:"w-full py-3 bg-red-100 text-red-700 font-black rounded-full hover:bg-red-200 transition-all text-sm flex items-center justify-center gap-2",children:[e.jsx(P,{size:16})," ",s("Cancel Mission")]})]}),c&&t.status!=="OUVERTE"&&t.status!=="TERMINEE"&&t.status!=="ANNULEE"&&e.jsxs("div",{className:"space-y-4 mb-6 pb-6 border-b border-gray-border",children:[e.jsx("p",{className:"text-xs font-black text-gray-muted uppercase tracking-widest mb-3",children:s("Mission Management")}),(t.status==="EN_NEGOCIATION"||t.status==="VERROUILLEE")&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{confirm(s("Reopen this mission? This will clear the current assignment."))&&n.post(route("missions.update-status",t.id),{status:"OUVERTE"})},className:"w-full py-3 bg-blue-100 text-blue-700 font-black rounded-full hover:bg-blue-200 transition-all text-sm flex items-center justify-center gap-2",children:[e.jsx(S,{size:14})," ",s("Reopen Mission")]}),e.jsxs("button",{onClick:()=>{confirm(s("Are you sure you want to cancel this mission?"))&&n.post(route("missions.update-status",t.id),{status:"ANNULEE"})},className:"w-full py-3 bg-red-100 text-red-700 font-black rounded-full hover:bg-red-200 transition-all text-sm flex items-center justify-center gap-2",children:[e.jsx(P,{size:14})," ",s("Cancel Mission")]})]})]}),t.status==="EN_NEGOCIATION"?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-50 text-blue-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(z,{size:32})}),e.jsx("h2",{className:"text-xl font-black text-oflem-charcoal mb-2",children:s("Negotiation Phase")}),e.jsx("p",{className:"text-sm text-gray-muted font-bold mb-6",children:s(c?"You have selected a provider. Confirm to reveal your address and move forward.":d?"Waiting for creators final confirmation...":"This mission is currently in negotiation.")}),c&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:()=>n.post(route("missions.confirm-assignment",t.id)),className:"w-full py-4 bg-gradient-to-br from-oflem-terracotta to-oflem-terracotta-light text-white font-black rounded-full hover:opacity-90 transition-all shadow-xl flex items-center justify-center gap-2",children:[e.jsx(w,{size:20})," ",s("Confirm Assignment")]}),x&&e.jsxs("button",{onClick:()=>m(!0),className:"w-full py-4 bg-green-500 text-white font-black rounded-full hover:bg-green-600 transition-all shadow-xl flex items-center justify-center gap-3 group",children:[e.jsx(le,{size:20,className:"group-hover:scale-110 transition-transform"})," ",s("Complete Payment Hold")]}),e.jsxs("button",{onClick:async()=>{const a=await b.get(route("api.missions.chat",t.id));n.visit(route("messages",{chat_id:a.data.id}))},className:"w-full py-4 bg-oflem-charcoal text-white font-black rounded-full hover:bg-oflem-charcoal transition-all flex items-center justify-center gap-3 group",children:[e.jsx(g,{size:20,className:"group-hover:scale-110 transition-transform"})," ",s("Message Provider")]})]}),d&&t.assigned_user_id&&t.chat&&e.jsxs("button",{onClick:async()=>{const a=await b.get(route("api.missions.chat",t.id));n.visit(route("messages",{chat_id:a.data.id}))},disabled:t.chat.status==="pending"||t.chat.status==="rejected",className:`w-full py-4 font-black rounded-full transition-all flex items-center justify-center gap-3 group ${t.chat.status==="pending"?"bg-oflem-cream text-oflem-charcoal cursor-not-allowed border border-oflem-terracotta/20":t.chat.status==="rejected"?"bg-red-50 text-red-500 cursor-not-allowed border border-red-100":"bg-oflem-charcoal text-white hover:bg-black"}`,children:[e.jsx(g,{size:20,className:t.chat.status==="active"?"group-hover:scale-110 transition-transform":""}),t.chat.status==="pending"?s("Contact Request Pending"):t.chat.status==="rejected"?s("Request Declined"):s("Message Creator")]})]}):t.status==="VERROUILLEE"?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-oflem-terracotta/10 text-oflem-terracotta rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(J,{size:32})}),e.jsx("h2",{className:"text-xl font-black text-oflem-charcoal mb-2",children:s(d?"Mission Assigned to You!":"Mission Booked")}),e.jsx("p",{className:"text-sm text-gray-muted font-bold mb-6",children:s(d?"You can now see the exact address and start the mission.":"This mission has already been assigned.")}),d&&t.chat&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:()=>n.post(route("missions.start-work",t.id)),className:"w-full py-4 bg-gradient-to-br from-oflem-terracotta to-oflem-terracotta-light text-white font-black rounded-full hover:opacity-90 transition-all shadow-xl flex items-center justify-center gap-3 group",children:[e.jsx(A,{size:20,className:"group-hover:rotate-12 transition-transform"})," ",s("Start Work Now")]}),e.jsxs("button",{onClick:async()=>{const a=await b.get(route("api.missions.chat",t.id));n.visit(route("messages",{chat_id:a.data.id}))},disabled:t.chat.status==="pending"||t.chat.status==="rejected",className:`w-full py-4 font-black rounded-full transition-all flex items-center justify-center gap-2 ${t.chat.status==="pending"?"bg-oflem-cream text-oflem-charcoal cursor-not-allowed border border-oflem-terracotta/20":t.chat.status==="rejected"?"bg-red-50 text-red-500 cursor-not-allowed border border-red-100":"bg-oflem-charcoal text-white hover:bg-black"}`,children:[e.jsx(g,{size:18,className:"inline"}),t.chat.status==="pending"?s("Request Pending"):t.chat.status==="rejected"?s("Declined"):s("Message Creator")]})]}),d&&!t.chat&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:()=>n.post(route("missions.start-work",t.id)),className:"w-full py-4 bg-gradient-to-br from-oflem-terracotta to-oflem-terracotta-light text-white font-black rounded-full hover:opacity-90 transition-all shadow-xl flex items-center justify-center gap-3 group",children:[e.jsx(A,{size:20,className:"group-hover:rotate-12 transition-transform"})," ",s("Start Work Now")]}),e.jsxs("button",{onClick:async()=>{await b.get(route("api.missions.chat",t.id)),n.reload()},className:"w-full py-4 bg-oflem-charcoal text-white font-black rounded-full hover:bg-black transition-all flex items-center justify-center gap-3 group",children:[e.jsx(g,{size:20,className:"group-hover:scale-110 transition-transform"})," ",s("Request Chat")]})]}),c&&e.jsxs("button",{onClick:async()=>{const a=await b.get(route("api.missions.chat",t.id));n.visit(route("messages",{chat_id:a.data.id}))},className:"w-full py-4 bg-oflem-charcoal text-white font-black rounded-full hover:bg-oflem-charcoal transition-all flex items-center justify-center gap-3 group",children:[e.jsx(g,{size:20,className:"group-hover:scale-110 transition-transform"})," ",s("Message Provider")]})]}):t.status==="EN_COURS"?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-oflem-terracotta/10 text-oflem-terracotta rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(F,{size:32,className:"animate-pulse"})}),e.jsx("h2",{className:"text-xl font-black text-oflem-charcoal mb-2",children:s("Work In Progress")}),e.jsx("p",{className:"text-sm text-gray-muted font-bold mb-6",children:s(d?"Finish the task and upload proof!":"The provider is currently working.")}),(c||t.chat)&&e.jsxs("button",{onClick:async()=>{const a=await b.get(route("api.missions.chat",t.id));n.visit(route("messages",{chat_id:a.data.id}))},className:"w-full py-4 bg-oflem-charcoal text-white font-black rounded-full hover:bg-oflem-charcoal transition-all flex items-center justify-center gap-3 group",children:[e.jsx(g,{size:20,className:"group-hover:scale-110 transition-transform"})," ",s(c?"Message Provider":"Message Creator")]})]}):c?e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:"text-xl font-black text-oflem-charcoal mb-6 flex items-center gap-3",children:[e.jsx(O,{className:"text-oflem-terracotta",size:24})," ",s("Offers")]}),e.jsx("div",{className:"space-y-6",children:t.offers.length>0?t.offers.map(a=>e.jsxs("div",{className:"elegant-capsule mt-0 !p-5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-black text-oflem-charcoal",children:a.user.name}),e.jsxs("p",{className:"text-xs text-gray-muted font-bold",children:[e.jsx(C,{size:12,className:"inline text-oflem-terracotta fill-oflem-terracotta"})," 5.0 (New)"]})]}),e.jsxs("p",{className:"text-lg font-black text-oflem-terracotta",children:["CHF ",a.amount]})]}),e.jsx("p",{className:"text-xs text-gray-muted font-medium mb-6 line-clamp-2",children:a.message}),t.status==="OUVERTE"&&e.jsxs("button",{onClick:()=>{n.post(route("missions.select-offer",{mission:t.id,offer:a.id}),{},{onSuccess:j=>{j.props.flash?.stripe_client_secret&&(u(j.props.flash.stripe_client_secret),m(!0))}})},className:"w-full py-3 bg-oflem-charcoal text-white font-black rounded-full hover:bg-black transition-all text-sm shadow-md flex items-center justify-center gap-2",children:[e.jsx(oe,{size:16})," ",s("Hire")," ",a.user.name]}),a.status==="accepted"&&e.jsx("div",{className:"text-center py-2 bg-gradient-to-br from-oflem-terracotta to-oflem-terracotta-light text-oflem-charcoal font-black text-[10px] uppercase rounded-full",children:s("Selected")})]},a.id)):e.jsx("p",{className:"text-gray-muted font-bold text-center text-sm",children:s("Waiting for offers...")})})]}):!c&&t.status==="OUVERTE"&&e.jsxs("div",{className:"space-y-8",children:[t.price_type==="fixed"&&e.jsxs("div",{className:"space-y-6 pb-6 border-b border-gray-border",children:[e.jsxs("div",{className:"text-center pb-6 border-b border-gray-border",children:[e.jsx("p",{className:"text-xs font-black text-zinc-400 uppercase tracking-widest mb-1",children:s("Fixed Price")}),e.jsxs("p",{className:"text-4xl font-black text-oflem-charcoal",children:["CHF ",t.budget]})]}),e.jsxs("button",{onClick:()=>{confirm(s("Are you sure you want to accept this mission? You will be committing to complete it for the fixed price shown."))&&q()},className:"w-full py-5 bg-oflem-charcoal text-white font-black rounded-full hover:bg-black transition-all shadow-xl text-lg flex items-center justify-center gap-3 group",children:[e.jsx(ce,{size:24,className:"text-oflem-terracotta group-hover:scale-110 transition-transform"})," ",s("Accept Instantly")]}),e.jsx("p",{className:"text-[10px] text-gray-muted font-bold text-center leading-relaxed",children:s("By accepting, you commit to completing this mission for the fixed price shown.")})]}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-black text-oflem-charcoal mb-4 flex items-center gap-3",children:t.price_type==="fixed"?s("Or Propose your Price"):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"text-oflem-terracotta",size:24})," ",s("Submit an Offer")]})}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"amount",value:s("Your price"),className:"text-xs uppercase tracking-widest font-black mb-3"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{id:"amount",type:"number",className:"w-full !pl-[85px]",placeholder:"0.00",value:r.data.amount,onChange:a=>r.setData("amount",a.target.value),required:!0}),e.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 font-black text-gray-muted/60",children:"CHF"})]}),e.jsx(_,{message:r.errors.amount,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"message",value:s("Message (Optional)"),className:"text-xs uppercase tracking-widest font-black mb-3"}),e.jsx("textarea",{id:"message",className:"w-full bg-oflem-cream border-gray-border rounded-[24px] p-5 text-sm font-medium focus:border-oflem-terracotta focus:ring-0 min-h-[100px]",placeholder:s("Tell the creator why you are a good fit..."),value:r.data.message,onChange:a=>r.setData("message",a.target.value)}),e.jsx(_,{message:r.errors.message,className:"mt-2"})]}),e.jsxs("button",{type:"submit",disabled:r.processing,className:"w-full py-5 bg-gradient-to-br from-oflem-terracotta to-oflem-terracotta-light text-white font-black rounded-full hover:opacity-90 transition-all shadow-xl text-lg flex items-center justify-center gap-3 group",children:[e.jsx(F,{size:24,className:"group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"})," ",s("Send Offer")]})]})]})]})})]}),c&&t.status==="OUVERTE"&&e.jsx("div",{className:"mt-8",children:e.jsx(xe,{mission:t,t:s})})]}),e.jsx(Q,{show:f,clientSecret:x,onClose:()=>m(!1),onSuccess:()=>{m(!1),i?.chat_id?n.visit(route("messages",{chat_id:i.chat_id})):n.reload()}})]})}function ue({missionId:t,t:l}){const{data:s,setData:o,post:i,processing:c,errors:d,progress:x}=v({completion_proof:null,completion_notes:""}),[u,f]=p.useState(null),m=h=>{const y=h.target.files[0];y&&(o("completion_proof",y),f(URL.createObjectURL(y)))},r=h=>{h.preventDefault(),i(route("missions.submit-validation",t),{forceFormData:!0,onSuccess:()=>{f(null)}})};return e.jsxs("form",{onSubmit:r,className:"space-y-6 bg-white rounded-[24px] p-6",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"completion_proof",value:l("Upload Photo Proof"),className:"text-xs uppercase tracking-widest font-black mb-3"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"file",id:"completion_proof",accept:"image/jpeg,image/png,image/jpg,image/webp",onChange:m,className:`block w-full text-sm text-gray-muted font-medium\r
                            file:mr-4 file:py-3 file:px-6\r
                            file:rounded-full file:border-0\r
                            file:text-sm file:font-black\r
                            file:bg-oflem-charcoal file:text-white\r
                            hover:file:bg-black file:cursor-pointer\r
                            cursor-pointer`,required:!0})}),e.jsx(_,{message:d.completion_proof,className:"mt-2"}),u&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:u,alt:"Preview",className:"w-full max-h-64 object-cover rounded-[16px] shadow-md"})})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"completion_notes",value:l("Completion Notes (Optional)"),className:"text-xs uppercase tracking-widest font-black mb-3"}),e.jsx("textarea",{id:"completion_notes",value:s.completion_notes,onChange:h=>o("completion_notes",h.target.value),className:"w-full bg-oflem-cream border-gray-border rounded-[24px] p-5 text-sm font-medium focus:border-oflem-terracotta focus:ring-0 min-h-[120px]",placeholder:l("Describe what you completed, any additional details..."),maxLength:1e3}),e.jsx(_,{message:d.completion_notes,className:"mt-2"}),e.jsxs("p",{className:"text-xs text-gray-muted font-bold mt-2",children:[s.completion_notes.length,"/1000 characters"]})]}),x&&e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-green-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${x.percentage}%`}})}),e.jsx("button",{type:"submit",disabled:c||!s.completion_proof,className:"w-full py-5 bg-green-600 text-white font-black rounded-full hover:bg-green-700 transition-all shadow-xl text-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l("Uploading...")]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{size:20})," ",l("Submit for Validation")]})}),e.jsxs("p",{className:"text-xs text-gray-muted font-bold text-center",children:[e.jsx(L,{size:14,className:"inline mr-1"})," ",l("The client will have 72 hours to validate your work")]})]})}function fe({missionId:t,questionId:l,t:s}){const{data:o,setData:i,post:c,processing:d,reset:x}=v({answer:""}),u=f=>{f.preventDefault(),c(route("missions.answer-question",{mission:t,question:l}),{preserveScroll:!0,onSuccess:()=>x()})};return e.jsxs("form",{onSubmit:u,className:"ml-12 mt-2 flex gap-4",children:[e.jsx(I,{value:o.answer,onChange:f=>i("answer",f.target.value),placeholder:s("Type your answer..."),className:"flex-1 !py-2 !px-4 !text-xs",required:!0}),e.jsx("button",{type:"submit",disabled:d,className:"px-6 py-2 bg-gradient-to-br from-oflem-terracotta to-oflem-terracotta-light text-oflem-charcoal font-black rounded-full hover:opacity-90 transition-all text-[10px] uppercase tracking-widest disabled:opacity-50",children:s("Answer")})]})}function k({icon:t,label:l,value:s,subValue:o}){return e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("span",{className:"text-2xl mt-1",children:t}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-muted uppercase tracking-widest mb-1",children:l}),e.jsx("p",{className:"font-black text-oflem-charcoal",children:s}),o&&e.jsx("p",{className:"text-[10px] font-bold text-oflem-terracotta mt-1 italic",children:o})]})]})}export{We as default};
