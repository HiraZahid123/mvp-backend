import{r as n,u as A,j as e,L as _,d as M}from"./app-BjoLlwmr.js";import{D as c}from"./Dropdown-DuoCLAAP.js";import"./transition-Co-eO5Tn.js";function E({initialTasks:b=[],user:o}){const[x,m]=n.useState([]),[h,p]=n.useState(!1),[k,f]=n.useState(!1),g=n.useRef(null),j=n.useRef(null),i=n.useRef(null),{data:r,setData:d,reset:L}=A({content:"",attachments:[]});n.useEffect(()=>{const t=b.flatMap(a=>{const s=[{id:`user-${a.id}`,type:"user",content:a.content,attachments:a.attachments,createdAt:new Date(a.created_at)}];return(a.status==="processed"||a.metadata)&&s.push({id:`ai-${a.id}`,type:"ai",content:a.metadata?.summary||"Task received.",metadata:a.metadata,createdAt:new Date(a.created_at)}),s}).sort((a,s)=>a.createdAt-s.createdAt);m(t)},[b]),n.useEffect(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[x]),n.useEffect(()=>{i.current&&(i.current.style.height="auto",i.current.style.height=Math.min(i.current.scrollHeight,150)+"px")},[r.content]);const y=t=>{if(t.preventDefault(),!r.content.trim()&&r.attachments.length===0)return;p(!0);const a=Date.now();m(u=>[...u,{id:a,type:"user",content:r.content,attachments:Array.from(r.attachments).map(N=>({file_name:N.name,preview:URL.createObjectURL(N)})),createdAt:new Date}]);const s=r.content,l=r.attachments;L("content","attachments"),M.post(route("tasks.store"),{content:s,attachments:l},{preserveScroll:!0,onSuccess:()=>p(!1),onError:()=>{p(!1),m(u=>[...u,{id:Date.now(),type:"error",content:"Failed. Please try again.",createdAt:new Date}])}})},C=t=>{const s=Array.from(t.target.files).map(l=>(l.preview=l.type.startsWith("image/")?URL.createObjectURL(l):null,l));d("attachments",[...r.attachments,...s])},v=t=>{d("attachments",r.attachments.filter((a,s)=>s!==t))},w=r.content.trim()||r.attachments.length>0;return e.jsxs("div",{className:"flex flex-col h-full bg-off-white-bg font-sans relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.02] pointer-events-none",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 1px 1px, black 1px, transparent 0)",backgroundSize:"40px 40px"}})}),e.jsx("header",{className:"relative z-50 flex-shrink-0 bg-off-white-bg/80 backdrop-blur-xl border-b border-gray-border/50",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(_,{href:route("dashboard"),className:"flex items-center gap-4 group",children:[e.jsxs("div",{className:"relative cursor-pointer",children:[e.jsx("div",{className:"w-10 h-10 rounded-2xl bg-gradient-to-br from-gold-accent to-yellow-500 flex items-center justify-center shadow-lg shadow-gold-accent/20 transition-transform group-hover:scale-105",children:e.jsx("span",{className:"text-primary-black font-black text-xs",children:"AI"})}),e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 border-2 border-off-white-bg rounded-full"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-black text-primary-black tracking-tight leading-none group-hover:text-gold-accent transition-colors",children:"Task Assistant"}),e.jsx("p",{className:"text-[10px] font-bold text-gray-muted mt-1 uppercase tracking-wider",children:"Powered by Oflem"})]})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"hidden md:inline-flex px-3 py-1 bg-cream-accent rounded-full text-[10px] font-black text-primary-black uppercase tracking-widest",children:"Beta"}),e.jsx("div",{className:"relative",children:e.jsxs(c,{children:[e.jsx(c.Trigger,{children:e.jsxs("button",{className:"flex items-center gap-2 focus:outline-none group cursor-pointer",children:[e.jsx("div",{className:"text-right hidden sm:block",children:e.jsx("p",{className:"text-sm font-bold text-primary-black group-hover:text-gold-accent transition-colors",children:o.name})}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-white border-2 border-gray-border flex items-center justify-center text-primary-black font-black text-sm shadow-sm group-hover:border-gold-accent transition-all overflow-hidden",children:o.avatar?e.jsx("img",{src:o.avatar,alt:o.name,className:"w-full h-full object-cover"}):o.name.charAt(0).toUpperCase()}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-gold-accent transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(c.Content,{children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[e.jsx("p",{className:"text-xs font-bold text-gray-muted uppercase tracking-wider",children:"Account"}),e.jsx("p",{className:"text-sm font-black text-primary-black truncate",children:o.email})]}),e.jsx(c.Link,{href:route("profile.edit"),children:"Profile Settings"}),e.jsx("div",{className:"border-t border-gray-100"}),e.jsx(c.Link,{href:route("logout"),method:"post",as:"button",className:"text-red-500 hover:text-red-600 hover:bg-red-50",children:"Log Out"})]})]})})]})]})}),e.jsx("main",{className:"relative z-10 flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-6 py-10 space-y-8",children:[x.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[50vh] text-center animate-in fade-in duration-700",children:[e.jsx("div",{className:"w-20 h-20 rounded-3xl bg-cream-accent flex items-center justify-center mb-8 shadow-lg",children:e.jsx("span",{className:"text-4xl",children:"✨"})}),e.jsx("h2",{className:"text-3xl font-black text-primary-black tracking-tight mb-3",children:"What can I help you with?"}),e.jsx("p",{className:"text-gray-muted font-bold text-base max-w-sm leading-relaxed",children:"Describe your task in detail and I'll analyze it, estimate costs, and help you get started."}),e.jsx("div",{className:"flex flex-wrap justify-center gap-3 mt-10",children:["Need a photographer","Home renovation","Event planning","Tech support"].map((t,a)=>e.jsx("button",{type:"button",onClick:()=>{d("content",t),i.current?.focus()},className:"px-5 py-2.5 bg-white border border-gray-border rounded-full text-sm font-bold text-gray-muted hover:border-gold-accent hover:text-primary-black hover:shadow-sm transition-all duration-300 active:scale-95",children:t},a))})]}),x.map((t,a)=>e.jsx("div",{className:`flex ${t.type==="user"?"justify-end":"justify-start"} animate-in slide-in-from-bottom-3 duration-500`,style:{animationDelay:`${a*50}ms`},children:e.jsxs("div",{className:"max-w-[85%] md:max-w-[75%]",children:[t.type==="ai"&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-gold-accent flex items-center justify-center",children:e.jsx("span",{className:"text-[10px] font-black text-primary-black",children:"AI"})}),e.jsx("span",{className:"text-[10px] font-black text-gray-muted uppercase tracking-widest",children:"Assistant"})]}),e.jsx("div",{className:`relative px-6 py-4 text-base font-medium leading-relaxed transition-all duration-300
                                    ${t.type==="user"?"bg-primary-black text-white rounded-3xl rounded-br-lg shadow-xl shadow-black/10":t.type==="error"?"bg-red-50 text-red-700 border border-red-100 rounded-3xl rounded-bl-lg":"bg-white text-primary-black border border-gray-border/50 rounded-3xl rounded-bl-lg shadow-sm"}`,children:e.jsx("p",{className:"whitespace-pre-wrap",children:t.content})}),t.attachments?.length>0&&e.jsx("div",{className:`flex flex-wrap gap-2 mt-3 ${t.type==="user"?"justify-end":"justify-start"}`,children:t.attachments.map((s,l)=>e.jsx("div",{className:"group relative",children:s.preview?e.jsx("div",{className:"w-16 h-16 rounded-xl overflow-hidden border-2 border-white shadow-md",children:e.jsx("img",{src:s.preview,className:"w-full h-full object-cover",alt:""})}):e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-border rounded-xl text-xs font-bold text-gray-muted shadow-sm",children:[e.jsx("svg",{className:"w-4 h-4 text-gold-accent",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),e.jsx("span",{className:"truncate max-w-[100px]",children:s.file_name})]})},l))}),t.metadata&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-4 animate-in fade-in duration-500 delay-300",children:[t.metadata.category&&e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-cream-accent rounded-full text-[10px] font-black text-primary-black uppercase tracking-widest",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-gold-accent"}),t.metadata.category]}),t.metadata.estimated_cost&&e.jsx("span",{className:"px-3 py-1.5 bg-gold-accent rounded-full text-[10px] font-black text-primary-black uppercase tracking-widest shadow-sm",children:t.metadata.estimated_cost}),t.metadata.timeline&&e.jsxs("span",{className:"px-3 py-1.5 bg-white border border-gray-border rounded-full text-[10px] font-black text-gray-muted uppercase tracking-widest",children:["⏱ ",t.metadata.timeline]})]}),e.jsx("div",{className:`mt-2 text-[10px] font-bold text-gray-muted/50 ${t.type==="user"?"text-right":"text-left"}`,children:t.createdAt.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},t.id)),h&&e.jsxs("div",{className:"flex justify-start animate-in slide-in-from-bottom-2 duration-300",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:"w-6 h-6 rounded-lg bg-gold-accent flex items-center justify-center",children:e.jsx("span",{className:"text-[10px] font-black text-primary-black",children:"AI"})})}),e.jsx("div",{className:"ml-2 px-6 py-4 bg-white border border-gray-border/50 rounded-3xl rounded-bl-lg shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2 h-2 bg-gray-300 rounded-full animate-[pulse_1.4s_ease-in-out_infinite]"}),e.jsx("span",{className:"w-2 h-2 bg-gold-accent rounded-full animate-[pulse_1.4s_ease-in-out_0.2s_infinite]"}),e.jsx("span",{className:"w-2 h-2 bg-gray-300 rounded-full animate-[pulse_1.4s_ease-in-out_0.4s_infinite]"})]})})]}),e.jsx("div",{ref:g})]})}),e.jsx("footer",{className:"relative z-20 bg-gradient-to-t from-off-white-bg via-off-white-bg to-transparent pt-8 pb-6 px-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[r.attachments.length>0&&e.jsx("div",{className:"flex flex-wrap gap-3 mb-4 animate-in slide-in-from-bottom-2 duration-300",children:Array.from(r.attachments).map((t,a)=>e.jsx("div",{className:"group relative",children:t.preview?e.jsxs("div",{className:"relative w-20 h-20 rounded-2xl overflow-hidden border-2 border-white shadow-lg",children:[e.jsx("img",{src:t.preview,className:"w-full h-full object-cover",alt:""}),e.jsx("button",{type:"button",onClick:()=>v(a),className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-white border border-gray-border rounded-2xl shadow-sm",children:[e.jsx("svg",{className:"w-5 h-5 text-gold-accent",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{className:"text-sm font-bold text-primary-black truncate max-w-[100px]",children:t.name}),e.jsx("button",{type:"button",onClick:()=>v(a),className:"text-gray-muted hover:text-red-500 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},a))}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-black text-primary-black",children:"Enter your mission"}),e.jsx("p",{className:"text-sm font-bold text-gray-muted mt-1",children:"Tell us what you need done — be as specific as possible"})]}),e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:`relative bg-white rounded-3xl border-2 transition-all duration-300 shadow-lg ${k?"border-gold-accent shadow-gold-accent/20 ring-4 ring-gold-accent/5":"border-gray-border"}`,children:[e.jsx("div",{className:"px-5 py-4",children:e.jsx("textarea",{ref:i,value:r.content,onChange:t=>d("content",t.target.value),onFocus:()=>f(!0),onBlur:()=>f(!1),placeholder:"e.g. I need a professional photographer for my wedding on March 15th in Paris...",rows:3,className:"w-full bg-transparent text-primary-black text-base font-medium placeholder:text-gray-muted/70 placeholder:font-medium focus:outline-none resize-none leading-relaxed",style:{maxHeight:"200px"},onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),y(t))}})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-border/50 bg-off-white-bg/50 rounded-b-3xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>j.current?.click(),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-bold text-gray-muted hover:text-primary-black hover:bg-white border border-transparent hover:border-gray-border transition-all duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),e.jsx("span",{className:"hidden sm:inline",children:"Attach"})]}),e.jsx("input",{type:"file",multiple:!0,ref:j,className:"hidden",onChange:C,accept:"image/*,.pdf,.doc,.docx"})]}),e.jsx("button",{type:"submit",disabled:h||!w,className:`flex items-center gap-2 px-6 py-2.5 rounded-full font-black text-sm transition-all duration-300 ${w?"bg-gold-accent text-primary-black shadow-md shadow-gold-accent/30 hover:opacity-90 active:scale-95":"bg-gray-border/50 text-gray-muted cursor-not-allowed"}`,children:h?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Submit Mission"}),e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})})]})]}),e.jsx("p",{className:"text-center text-[10px] font-bold text-gray-muted/40 mt-4",children:"Press Enter to submit • Shift+Enter for new line"})]})]})})]})}export{E as default};
