import{r as t,j as e,u as C,H as E}from"./app-B8uIr0Ne.js";import{A as _}from"./AuthSplitLayout-B_OR0Q5_.js";import{I as w}from"./InputError-Bdu1Amg2.js";import{P as L}from"./PrimaryButton-BMeNA5Zc.js";import"./LanguageSwitcher-DWDkmZLc.js";function R({title:a,titleId:o,...i},d){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":o},i),a?t.createElement("title",{id:o},a):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const S=t.forwardRef(R);function V({title:a,titleId:o,...i},d){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":o},i),a?t.createElement("title",{id:o},a):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z"}))}const M=t.forwardRef(V);function P({role:a,onLocationSelect:o,defaultMethod:i="gps",defaultZipCode:d="",defaultRadius:h=10}){const[l,x]=t.useState(i),[c,u]=t.useState(d),[r,f]=t.useState(h),[n,j]=t.useState(null),[b,p]=t.useState(!1),[v,m]=t.useState(null),y={customer:"Votre zone de confort ?",performer:"Votre zone d'intervention ?",both:"Votre périmètre d'action ?"},N=y[a]||y.both,k=()=>{if(p(!0),m(null),!navigator.geolocation){m("La géolocalisation n'est pas supportée par votre navigateur."),p(!1);return}navigator.geolocation.getCurrentPosition(s=>{const g={lat:s.coords.latitude,lng:s.coords.longitude};j(g),p(!1),o&&o({method:"gps",...g,radius:r})},s=>{m("Impossible d'obtenir votre position. Veuillez réessayer."),p(!1)})},z=s=>{if(s?.preventDefault(),!c){m("Veuillez saisir un code postal.");return}p(!0),m(null),setTimeout(()=>{const g={lat:48.8566,lng:2.3522};j(g),p(!1),o&&o({method:"zipcode",zip_code:c,...g,radius:r})},500)};return t.useEffect(()=>{n&&o&&o({method:l,zip_code:l==="zipcode"?c:null,location_lat:n.lat,location_lng:n.lng,discovery_radius_km:r})},[r]),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-black text-primary-black text-center",children:N}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>x("gps"),className:`
                        p-4 rounded-[24px] border-2 transition-all duration-300
                        ${l==="gps"?"border-gold-accent bg-gold-accent/10":"border-gray-border/50 bg-white hover:border-gold-accent/50"}
                    `,children:[e.jsx(S,{className:"w-8 h-8 mx-auto mb-2 text-gold-accent"}),e.jsx("p",{className:"text-sm font-bold text-primary-black",children:"Me géolocaliser"})]}),e.jsxs("button",{type:"button",onClick:()=>x("zipcode"),className:`
                        p-4 rounded-[24px] border-2 transition-all duration-300
                        ${l==="zipcode"?"border-gold-accent bg-gold-accent/10":"border-gray-border/50 bg-white hover:border-gold-accent/50"}
                    `,children:[e.jsx(M,{className:"w-8 h-8 mx-auto mb-2 text-gold-accent"}),e.jsx("p",{className:"text-sm font-bold text-primary-black",children:"Code postal"})]})]}),l==="gps"&&e.jsx("div",{className:"space-y-4",children:e.jsx("button",{type:"button",onClick:k,disabled:b,className:`\r
                            w-full px-6 py-4 \r
                            bg-gold-accent text-white\r
                            rounded-[24px]\r
                            font-bold text-base\r
                            hover:bg-gold-accent/90\r
                            disabled:opacity-50 disabled:cursor-not-allowed\r
                            transition-all duration-300\r
                        `,children:b?"Localisation...":"Obtenir ma position"})}),l==="zipcode"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",value:c,onChange:s=>u(s.target.value),placeholder:"Ex: 75001",className:`\r
                            w-full px-4 py-3\r
                            bg-input-bg border border-gray-border/50\r
                            rounded-[24px]\r
                            text-primary-black text-base\r
                            placeholder:text-gray-muted/60\r
                            focus:outline-none focus:ring-2 focus:ring-gold-accent/30 focus:border-gold-accent\r
                            transition-all duration-200\r
                        `}),e.jsx("button",{type:"button",onClick:z,disabled:b||!c,className:`\r
                            w-full px-6 py-4\r
                            bg-gold-accent text-white\r
                            rounded-[24px]\r
                            font-bold text-base\r
                            hover:bg-gold-accent/90\r
                            disabled:opacity-50 disabled:cursor-not-allowed\r
                            transition-all duration-300\r
                        `,children:b?"Recherche...":"Valider"})]}),v&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-[24px]",children:e.jsx("p",{className:"text-sm text-red-600",children:v})}),n&&e.jsxs("div",{className:"space-y-4 p-6 bg-gold-accent/5 rounded-[24px] border border-gold-accent/30",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-600",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm font-bold",children:"Position confirmée"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-bold text-primary-black",children:["Rayon de découverte: ",e.jsxs("span",{className:"text-gold-accent",children:[r," km"]})]}),e.jsx("input",{type:"range",min:"5",max:"20",value:r,onChange:s=>f(parseInt(s.target.value)),className:"w-full h-2 bg-gray-200 rounded-full appearance-none cursor-pointer slider",style:{background:`linear-gradient(to right, #C57B67 0%, #C57B67 ${(r-5)/15*100}%, #E5E5E5 ${(r-5)/15*100}%, #E5E5E5 100%)`}}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-muted font-medium",children:[e.jsx("span",{children:"5 km"}),e.jsx("span",{children:"20 km"})]})]})]})]})}function O({user:a,role:o}){const[i,d]=t.useState(null),{data:h,setData:l,post:x,processing:c,errors:u}=C({method:"gps",location_lat:null,location_lng:null,zip_code:null,location_address:null,discovery_radius_km:10}),r=n=>{d(n),l({...h,...n})},f=n=>{n.preventDefault(),x(route("auth.complete-location.store"))};return e.jsxs(_,{heroImage:"/register-page-hero.svg",heroHeading:"Définissez votre zone",heroSubtext:"Où souhaitez-vous agir ?",bgAccentClass:"bg-cream-accent",children:[e.jsx(E,{title:"Localisation"}),e.jsxs("form",{onSubmit:f,className:"space-y-8",children:[e.jsx(P,{role:o||a?.role_type,onLocationSelect:r,defaultRadius:10}),u.location_lat&&e.jsx(w,{message:u.location_lat}),u.zip_code&&e.jsx(w,{message:u.zip_code}),e.jsx(L,{className:"w-full",disabled:c||!i,children:c?"Enregistrement...":"Confirmer ma zone"})]}),e.jsx("div",{className:"mt-6 p-4 bg-gold-accent/5 rounded-[24px] border border-gold-accent/20",children:e.jsx("p",{className:"text-xs text-gray-muted text-center",children:"Votre position est utilisée uniquement pour vous connecter avec des opportunités locales."})})]})}export{O as default};
