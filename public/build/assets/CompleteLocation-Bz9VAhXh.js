import{r as t,j as e,u as K,H as U}from"./app-3ui6Zh4V.js";import{A as Z}from"./AuthSplitLayout-CmlCreZT.js";import{u as B}from"./useTranslation-C36Wy86N.js";import{u as W,G as q,M as Q,C as Y}from"./esm-BO4OLmwt.js";import{F as J}from"./MapPinIcon-CthXvUFP.js";import{I}from"./InputError-dyO9oETY.js";import{P as X}from"./PrimaryButton-Ft17DT6_.js";import"./LanguageSwitcher-Ct-b8yFw.js";function ee({title:m,titleId:l,...p},h){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:h,"aria-labelledby":l},p),m?t.createElement("title",{id:l},m):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z"}))}const te=t.forwardRef(ee),oe=["places"];function ae({role:m,onLocationSelect:l,defaultMethod:p="gps",defaultZipCode:h="",defaultRadius:N=10}){const{t:o}=B(),[s,j]=t.useState(p),[d,x]=t.useState(h),[n,_]=t.useState(N),[c,v]=t.useState(null),[b,L]=t.useState(""),[w,u]=t.useState(!1),[E,f]=t.useState(null),[O,S]=t.useState({lat:48.8566,lng:2.3522}),[k,C]=t.useState(null),{isLoaded:P,loadError:D}=W({googleMapsApiKey:"AIzaSyAaeyO3ffYCdUpAHU0kQx3TsHGhlbaIgkA",libraries:oe}),A={customer:"Votre zone de confort ?",performer:"Votre zone d'intervention ?",both:"Votre périmètre d'action ?"},F=A[m]||A.both,z=t.useCallback((r,a)=>{window.google&&window.google.maps&&new window.google.maps.Geocoder().geocode({location:{lat:r,lng:a}},(g,y)=>{if(y==="OK"&&g[0]){const R=g[0].formatted_address;L(R);const H=g[0].address_components;for(const V of H)if(V.types.includes("postal_code")){V.long_name;break}return R}})},[s]),M=t.useCallback(r=>{const a=r.latLng.lat(),i=r.latLng.lng(),g={lat:a,lng:i};C(g),v(g),z(a,i),l&&l({method:s,location_lat:a,location_lng:i,discovery_radius_km:n,location_address:b})},[s,n,l,z,b]);t.useEffect(()=>{c&&l&&l({method:s,zip_code:s==="zipcode"?d:null,location_lat:c.lat,location_lng:c.lng,discovery_radius_km:n,location_address:b})},[b,c,n,s,d]);const G=()=>{if(u(!0),f(null),!navigator.geolocation){f(o("La géolocalisation n'est pas supportée par votre navigateur.")),u(!1);return}navigator.geolocation.getCurrentPosition(r=>{const a={lat:r.coords.latitude,lng:r.coords.longitude};v(a),C(a),S(a),z(a.lat,a.lng),u(!1)},r=>{f(o("Impossible d'obtenir votre position. Veuillez réessayer.")),u(!1)})},T=r=>{if(r?.preventDefault(),!d){f(o("Veuillez saisir un code postal."));return}u(!0),f(null),window.google&&window.google.maps?new window.google.maps.Geocoder().geocode({address:d},(i,g)=>{if(g==="OK"&&i[0]){const y={lat:i[0].geometry.location.lat(),lng:i[0].geometry.location.lng()};v(y),C(y),S(y),L(i[0].formatted_address),u(!1)}else f(o("Impossible de trouver ce code postal.")),u(!1)}):setTimeout(()=>{const a={lat:48.8566,lng:2.3522};v(a),C(a),L("Paris, France (Simulated)"),u(!1)},500)},$={width:"100%",height:"300px",borderRadius:"1.5rem",marginTop:"1rem"};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-black text-primary-black text-center",children:o(F)}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>j("gps"),className:`
                        p-4 rounded-[24px] border-2 transition-all duration-300
                        ${s==="gps"?"border-gold-accent bg-gold-accent/10":"border-gray-border/50 bg-white hover:border-gold-accent/50"}
                    `,children:[e.jsx(J,{className:"w-8 h-8 mx-auto mb-2 text-gold-accent"}),e.jsx("p",{className:"text-sm font-bold text-primary-black",children:o("Me géolocaliser")})]}),e.jsxs("button",{type:"button",onClick:()=>j("zipcode"),className:`
                        p-4 rounded-[24px] border-2 transition-all duration-300
                        ${s==="zipcode"?"border-gold-accent bg-gold-accent/10":"border-gray-border/50 bg-white hover:border-gold-accent/50"}
                    `,children:[e.jsx(te,{className:"w-8 h-8 mx-auto mb-2 text-gold-accent"}),e.jsx("p",{className:"text-sm font-bold text-primary-black",children:o("Code postal")})]})]}),s==="gps"&&e.jsx("div",{className:"space-y-4",children:e.jsx("button",{type:"button",onClick:G,disabled:w,className:`\r
                            w-full px-6 py-4 \r
                            bg-gold-accent text-white\r
                            rounded-[24px]\r
                            font-bold text-base\r
                            hover:bg-gold-accent/90\r
                            disabled:opacity-50 disabled:cursor-not-allowed\r
                            transition-all duration-300\r
                        `,children:o(w?"Localisation...":"Obtenir ma position")})}),s==="zipcode"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",value:d,onChange:r=>x(r.target.value),placeholder:o("Ex: 75001"),className:`\r
                            w-full px-4 py-3\r
                            bg-input-bg border border-gray-border/50\r
                            rounded-[24px]\r
                            text-primary-black text-base\r
                            placeholder:text-gray-muted/60\r
                            focus:outline-none focus:ring-2 focus:ring-gold-accent/30 focus:border-gold-accent\r
                            transition-all duration-200\r
                        `}),e.jsx("button",{type:"button",onClick:T,disabled:w||!d,className:`\r
                            w-full px-6 py-4\r
                            bg-gold-accent text-white\r
                            rounded-[24px]\r
                            font-bold text-base\r
                            hover:bg-gold-accent/90\r
                            disabled:opacity-50 disabled:cursor-not-allowed\r
                            transition-all duration-300\r
                        `,children:o(w?"Recherche...":"Valider")})]}),E&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-[24px]",children:e.jsx("p",{className:"text-sm text-red-600",children:E})}),c&&e.jsxs("div",{className:"space-y-4 p-6 bg-gold-accent/5 rounded-[24px] border border-gold-accent/30",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-600",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm font-bold",children:o("Position confirmée")})]}),b&&e.jsx("div",{className:"w-full px-4 py-3 bg-white border border-gray-border/50 rounded-[16px] text-center",children:e.jsx("p",{className:"text-sm text-gray-700 font-medium",children:b})}),e.jsx("div",{className:"rounded-[24px] overflow-hidden border border-gray-border relative",children:P?e.jsx(q,{mapContainerStyle:$,center:k||O,zoom:12,onClick:M,options:{disableDefaultUI:!0,zoomControl:!1,styles:[{featureType:"all",elementType:"geometry",stylers:[{color:"#f5f5f5"}]}]},children:k&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{position:k,draggable:!0,onDragEnd:M}),e.jsx(Y,{center:k,radius:n*1e3,options:{strokeColor:"#C57B67",strokeOpacity:1,strokeWeight:3,fillColor:"#C57B67",fillOpacity:.2,clickable:!1,editable:!1,draggable:!1}},`circle-${n}`)]})}):e.jsx("div",{className:"w-full h-[300px] bg-gray-100 flex items-center justify-center italic text-gray-400",children:D?"Error loading maps":"Loading map..."})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-bold text-primary-black",children:[o("Rayon de découverte:")," ",e.jsxs("span",{className:"text-gold-accent",children:[n," km"]})]}),e.jsx("input",{type:"range",min:"5",max:"50",value:n,onChange:r=>_(parseInt(r.target.value)),className:"w-full h-2 bg-gray-200 rounded-full appearance-none cursor-pointer slider",style:{background:`linear-gradient(to right, #C57B67 0%, #C57B67 ${(n-5)/45*100}%, #E5E5E5 ${(n-5)/45*100}%, #E5E5E5 100%)`}}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-muted font-medium",children:[e.jsx("span",{children:"5 km"}),e.jsx("span",{children:"50 km"})]})]})]})]})}function ue({user:m,role:l}){const{t:p}=B(),[h,N]=t.useState(null),{data:o,setData:s,post:j,processing:d,errors:x}=K({method:"gps",location_lat:null,location_lng:null,zip_code:null,location_address:null,discovery_radius_km:10}),n=c=>{N(c),s({...o,...c})},_=c=>{c.preventDefault(),j(route("auth.complete-location.store"))};return e.jsxs(Z,{heroImage:"/images/illustrations/login-hero.svg",bgAccentClass:"bg-cream-accent",children:[e.jsx(U,{title:p("Localisation")}),e.jsxs("form",{onSubmit:_,className:"space-y-8",children:[e.jsx(ae,{role:l||m?.role_type,onLocationSelect:n,defaultRadius:10}),x.location_lat&&e.jsx(I,{message:x.location_lat}),x.zip_code&&e.jsx(I,{message:x.zip_code}),e.jsx(X,{className:"w-full",disabled:d||!h,children:p(d?"Enregistrement...":"Confirmer ma zone")})]}),e.jsx("div",{className:"mt-6 p-4 bg-gold-accent/5 rounded-[24px] border border-gold-accent/20",children:e.jsx("p",{className:"text-xs text-gray-muted text-center",children:p("Votre position est utilisée uniquement pour vous connecter avec des opportunités locales.")})})]})}export{ue as default};
