import{a as b,u as N,j as e,c as g,r as o,b as v,H as S,L as M}from"./app-A1xlY4m9.js";import{u as A}from"./useTranslation-CZmQ0Q5i.js";import{A as O}from"./AuthenticatedLayout-C7me-8XA.js";import{T as _}from"./TextInput-CPYO3mol.js";import{I as y}from"./InputLabel-DTHWUUBM.js";import{I as k}from"./InputError-CNaDBl3r.js";import{M as F}from"./Modal-CsuYfX9M.js";import{P}from"./PaymentModal-BTFq2V3u.js";import"./Header-DVwODtto.js";import"./transition-B_ij8g4g.js";import"./Footer-Dl-YXm00.js";import"./PrimaryButton-BYnb9F3e.js";import"./SecondaryButton-DByHCuXh.js";function T({missionId:t,t:l}){const[s,c]=b.useState(!1),{data:i,setData:n,post:d,processing:x,reset:u}=N({reason:""}),p=m=>{m.preventDefault(),d(route("missions.dispute",t),{onSuccess:()=>{u(),c(!1)}})};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>c(!0),className:"py-5 bg-red-600 text-white font-black rounded-full hover:bg-red-700 transition-all shadow-xl text-lg flex items-center justify-center gap-2",children:["âš ï¸ ",l("Open Dispute")]}),e.jsx(F,{show:s,onClose:()=>c(!1),maxWidth:"2xl",children:e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-black text-primary-black mb-4",children:"Open a Dispute"}),e.jsx("p",{className:"text-sm text-gray-muted font-medium mb-6",children:"Please explain why you're not satisfied with the work. An admin will review your case."}),e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"reason",value:"Reason for Dispute",className:"text-xs uppercase tracking-widest font-black mb-3"}),e.jsx("textarea",{id:"reason",className:"w-full bg-oflem-cream border-gray-border rounded-[24px] p-5 text-sm font-medium focus:border-gold-accent focus:ring-0 min-h-[150px]",placeholder:"Describe the issue in detail...",value:i.reason,onChange:m=>n("reason",m.target.value),required:!0})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"flex-1 py-3 bg-gray-200 text-primary-black font-black rounded-full hover:bg-gray-300 transition-all",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:x,className:"flex-1 py-3 bg-red-600 text-white font-black rounded-full hover:bg-red-700 transition-all disabled:opacity-50",children:"Submit Dispute"})]})]})]})})]})}function I({motive:t,t:l}){return e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-80 bg-white rounded-[24px] p-6 shadow-2xl border-2 border-gold-accent z-50 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4 pb-4 border-b border-gray-border",children:[e.jsx("img",{src:t.profile_photo_url||t.avatar||"/images/avatars/default-avatar.svg",alt:t.name,className:"w-16 h-16 rounded-full object-cover border-3 border-gold-accent shadow-lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-black text-lg text-primary-black mb-1",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-muted font-medium",children:["@",t.username||"user"]}),e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[[...Array(5)].map((s,c)=>e.jsx("span",{className:`text-sm ${c<Math.round(parseFloat(t.rating_cache||0))?"text-gold-accent":"text-gray-300"}`,children:"â˜…"},c)),e.jsxs("span",{className:"text-xs font-bold text-gray-muted ml-1",children:["(",t.reviews_count_cache||0,")"]})]})]})]}),t.matched_skills&&t.matched_skills.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-muted uppercase tracking-wider mb-2",children:l("Matched Skills")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.matched_skills.slice(0,3).map((s,c)=>e.jsx("span",{className:"px-3 py-1 bg-gold-accent/10 text-gold-accent text-xs font-bold rounded-full",children:s},c))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[t.provider_profile?.years_experience&&e.jsxs("div",{className:"bg-oflem-cream rounded-[16px] p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-primary-black",children:t.provider_profile.years_experience}),e.jsx("p",{className:"text-[9px] font-black text-gray-muted uppercase tracking-wider",children:l("Years Exp")})]}),t.distance_km&&e.jsxs("div",{className:"bg-oflem-cream rounded-[16px] p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-black text-primary-black",children:t.distance_km}),e.jsx("p",{className:"text-[9px] font-black text-gray-muted uppercase tracking-wider",children:l("km away")})]})]}),t.provider_profile?.bio&&e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:"text-xs text-gray-muted font-medium line-clamp-3",children:t.provider_profile.bio})})]})}function R({mission:t,t:l}){const[s,c]=b.useState([]),[i,n]=b.useState(!0),[d,x]=b.useState(null),[u,p]=b.useState(null);b.useEffect(()=>{g.get(route("missions.nearby-motives",t.id)).then(r=>{c(r.data.nearby_motives),n(!1)}).catch(r=>{console.error("Error fetching nearby MotivÃ©s:",r),n(!1)})},[t.id]);const m=r=>{x(r),o.post(route("missions.send-to-motive",{mission:t.id,motive:r}),{},{onFinish:()=>x(null)})};return i?e.jsx("section",{className:"bg-white rounded-[40px] p-8 shadow-sm border border-gray-border",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-gold-accent border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"mt-4 text-sm font-bold text-gray-muted",children:l("Finding nearby helpers...")})]})}):s.length===0?e.jsxs("section",{className:"bg-white rounded-[40px] p-8 shadow-sm border border-gray-border",children:[e.jsxs("h2",{className:"text-2xl font-black text-primary-black mb-6",children:["ðŸ—ºï¸ ",l("Nearby Helpers")]}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ”"}),e.jsx("p",{className:"text-gray-muted font-bold",children:l("No helpers found nearby")}),e.jsx("p",{className:"text-xs text-gray-muted mt-2",children:l("Try expanding your search radius or wait for offers")})]})]}):e.jsxs("section",{className:"bg-white rounded-[40px] p-8 shadow-sm border border-gray-border",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-2xl font-black text-primary-black mb-2",children:["ðŸ—ºï¸ ",l("Nearby Helpers")]}),e.jsxs("p",{className:"text-sm text-gray-muted font-medium",children:[l("Found")," ",s.length," ",l("helpers near your mission location")]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(r=>e.jsxs("div",{className:"relative group",onMouseEnter:()=>p(r),onMouseLeave:()=>p(null),children:[e.jsxs("div",{className:"bg-oflem-cream rounded-[24px] p-5 border-2 border-transparent hover:border-gold-accent transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("img",{src:r.profile_photo_url||r.avatar||"/images/avatars/default-avatar.svg",alt:r.name,className:"w-12 h-12 rounded-full object-cover border-2 border-white shadow-md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-black text-primary-black truncate",children:r.name}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gold-accent text-sm",children:"â˜…"}),e.jsx("span",{className:"text-xs font-bold text-gray-muted",children:parseFloat(r.rating_cache||0).toFixed(1)}),r.distance_km&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-300 mx-1",children:"â€¢"}),e.jsxs("span",{className:"text-xs font-bold text-gray-muted",children:[r.distance_km," km"]})]})]})]})]}),r.match_score>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-muted uppercase tracking-wider",children:l("Match Score")}),e.jsxs("span",{className:"text-xs font-black text-primary-black",children:[r.match_score,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-gold-accent to-[#D4AF37] rounded-full",style:{width:`${Math.min(r.match_score,100)}%`}})})]}),e.jsx("button",{onClick:()=>m(r.id),disabled:d===r.id,className:"w-full py-3 bg-primary-black text-white font-black rounded-full hover:bg-black transition-all text-sm disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:d===r.id?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),l("Sending...")]}):e.jsxs(e.Fragment,{children:["ðŸ“¤ ",l("Send Mission")]})})]}),u?.id===r.id&&e.jsx(I,{motive:r,t:l})]},r.id))})]})}function X({mission:t,canSeeAddress:l}){const{t:s}=A(),{auth:c,flash:i}=v().props,n=Number(c.user.id)===Number(t.user_id),d=Number(c.user.id)===Number(t.assigned_user_id),[x,u]=b.useState(i?.stripe_client_secret||v().props.stripe_client_secret||null),[p,m]=b.useState(!!x);b.useEffect(()=>{i?.stripe_client_secret&&(u(i.stripe_client_secret),m(!0))},[i]),b.useEffect(()=>{if(i?.chat_id&&!i?.stripe_client_secret){const a=setTimeout(()=>{o.visit(route("messages",{chat_id:i.chat_id}))},1e3);return()=>clearTimeout(a)}},[i?.chat_id,i?.stripe_client_secret]),b.useEffect(()=>(window.Echo.private(`mission.${t.id}`).listen("QuestionPosted",a=>{o.reload({only:["mission"]})}).listen("AnswerPosted",a=>{o.reload({only:["mission"]})}).listen("MissionStatusUpdated",a=>{o.reload({only:["mission"]})}),()=>{window.Echo.leave(`mission.${t.id}`)}),[t.id]);const r=N({amount:"",message:""}),h=N({question:""}),j=a=>{a.preventDefault(),r.post(route("missions.submit-offer",t.id),{onSuccess:f=>{r.reset(),f.props.flash?.stripe_client_secret&&(u(f.props.flash.stripe_client_secret),m(!0))}})},E=a=>{a.preventDefault(),h.post(route("missions.ask-question",t.id),{onSuccess:()=>h.reset()})},C=()=>{o.post(route("missions.accept",t.id),{},{onSuccess:a=>{a.props.flash?.stripe_client_secret&&(u(a.props.flash.stripe_client_secret),m(!0))}})};return e.jsxs(O,{header:t.title,maxWidth:"max-w-6xl",showFooter:!0,children:[e.jsx(S,{title:`${t.title} - Oflem`}),e.jsxs("div",{className:"py-16 px-6",children:[e.jsxs("div",{className:"grid lg:grid-cols-3 gap-12",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs("section",{className:"bg-white rounded-[40px] p-8 md:p-12 shadow-sm border border-gray-border",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-8",children:[e.jsx("span",{className:"px-4 py-1.5 bg-cream-accent text-primary-black text-[10px] font-black uppercase tracking-widest rounded-full",children:s(t.category||"General")}),t.status==="OUVERTE"?e.jsxs("span",{className:"px-4 py-1.5 bg-green-100 text-green-700 text-[10px] font-black uppercase tracking-widest rounded-full",children:["ðŸŸ¢ ",s("Open")]}):t.status==="EN_NEGOCIATION"?e.jsx("span",{className:"px-4 py-1.5 bg-blue-100 text-blue-700 text-[10px] font-black uppercase tracking-widest rounded-full",children:t.assigned_user_id?`ðŸ”’ ${s("Reserved")}`:`ðŸ¤ ${s("In Negotiation")}`}):t.status==="VERROUILLEE"?e.jsxs("span",{className:"px-4 py-1.5 bg-gold-accent text-primary-black text-[10px] font-black uppercase tracking-widest rounded-full",children:["âœ… ",s("Assigned")]}):t.status==="EN_COURS"?e.jsxs("span",{className:"px-4 py-1.5 bg-yellow-400/20 text-yellow-700 text-[10px] font-black uppercase tracking-widest rounded-full",children:["â³ ",s("In Progress")]}):t.status==="EN_VALIDATION"?e.jsxs("span",{className:"px-4 py-1.5 bg-orange-100 text-orange-700 text-[10px] font-black uppercase tracking-widest rounded-full",children:["âœ… ",s("In Validation")]}):e.jsx("span",{className:"px-4 py-1.5 bg-gray-100 text-gray-700 text-[10px] font-black uppercase tracking-widest rounded-full",children:s(t.status)})]}),e.jsx("h1",{className:"text-4xl font-black text-primary-black mb-6",children:t.title}),e.jsx("div",{className:"prose prose-sm max-w-none text-gray-muted font-medium mb-12 leading-relaxed",children:t.description.split(`
`).map((a,f)=>e.jsx("p",{className:"mb-4",children:a},f))}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 pt-8 border-t border-gray-border",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(w,{icon:"ðŸ’°",label:s("Budget"),value:t.budget?`CHF ${t.budget}`:s("Open for offers")}),e.jsx(w,{icon:"ðŸ“…",label:s("Requested Date"),value:t.date_time?new Date(t.date_time).toLocaleString():s("Flexible")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(w,{icon:"ðŸ“",label:s("Location"),value:l?t.exact_address||t.location:t.location||s("Approximate location"),subValue:!l&&s("Exact address revealed after assignment")}),e.jsx(w,{icon:"ðŸ‘¤",label:s("Posted by"),value:t.user.name})]})]})]}),e.jsxs("section",{className:"bg-white rounded-[40px] p-8 md:p-12 shadow-sm border border-gray-border",children:[e.jsxs("h2",{className:"text-2xl font-black text-primary-black mb-8",children:["ðŸ’¬ ",s("Questions & Answers")]}),e.jsx("div",{className:"space-y-8 mb-10",children:t.questions.length>0?t.questions.map(a=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-oflem-cream flex items-center justify-center font-black",children:a.user.name.charAt(0)}),e.jsxs("div",{className:"bg-oflem-cream p-5 rounded-[24px] flex-1",children:[e.jsx("p",{className:"text-sm font-bold text-primary-black mb-1",children:a.user.name}),e.jsx("p",{className:"text-sm text-gray-muted font-medium",children:a.question})]})]}),a.answer?e.jsxs("div",{className:"flex gap-4 ml-12",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-cream-accent flex items-center justify-center font-black",children:t.user.name.charAt(0)}),e.jsxs("div",{className:"bg-cream-accent p-5 rounded-[24px] flex-1 border border-gold-accent/20",children:[e.jsxs("p",{className:"text-sm font-bold text-primary-black mb-1",children:[t.user.name," ",e.jsx("span",{className:"text-[10px] uppercase text-gold-accent ml-2",children:s("Creator")})]}),e.jsx("p",{className:"text-sm text-gray-muted font-medium",children:a.answer})]})]}):n&&e.jsx(U,{missionId:t.id,questionId:a.id,t:s})]},a.id)):e.jsx("p",{className:"text-gray-muted font-bold text-center py-4",children:s("No questions yet.")})}),!n&&t.status==="OUVERTE"&&e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsx(y,{htmlFor:"question",value:s("Ask a question"),className:"text-xs uppercase tracking-widest font-black"}),e.jsx("textarea",{id:"question",className:"w-full bg-oflem-cream border-gray-border rounded-[24px] p-5 text-sm font-medium focus:border-gold-accent focus:ring-0 min-h-[100px]",placeholder:s("Ask for more details about the mission..."),value:h.data.question,onChange:a=>h.setData("question",a.target.value),required:!0}),e.jsx("button",{type:"submit",disabled:h.processing,className:"px-8 py-3 bg-primary-black text-white font-black rounded-full hover:bg-black transition-all text-sm disabled:opacity-50",children:s("Post Question")})]})]}),t.status==="EN_VALIDATION"&&n&&e.jsxs("section",{className:"bg-gradient-to-br from-gold-accent/10 to-cream-accent rounded-[40px] p-8 md:p-12 shadow-lg border-2 border-gold-accent",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"â³"}),e.jsx("h2",{className:"text-3xl font-black text-primary-black mb-2",children:"Validation Required"}),e.jsx("p",{className:"text-sm text-gray-muted font-bold",children:"The performer has submitted their work. Please review and validate or dispute."})]}),t.completion_proof_path&&e.jsxs("div",{className:"mb-8 bg-white rounded-[24px] p-6",children:[e.jsx("h3",{className:"text-lg font-black text-primary-black mb-4",children:"ðŸ“¸ Proof of Completion"}),e.jsx("img",{src:`/storage/${t.completion_proof_path}`,alt:"Completion Proof",className:"w-full rounded-[16px] mb-4 shadow-md"}),t.completion_notes&&e.jsxs("div",{className:"bg-oflem-cream rounded-[16px] p-4",children:[e.jsx("p",{className:"text-xs font-black text-gray-muted uppercase tracking-widest mb-2",children:"Notes from Performer"}),e.jsx("p",{className:"text-sm text-primary-black font-medium",children:t.completion_notes})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>{confirm("Are you sure you want to validate this mission? Payment will be released to the performer.")&&o.post(route("missions.validate",t.id))},className:"py-5 bg-green-600 text-white font-black rounded-full hover:bg-green-700 transition-all shadow-xl text-lg flex items-center justify-center gap-2",children:["âœ… ",s("Validate & Release Payment")]}),e.jsx(T,{missionId:t.id,t:s})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:async()=>{const a=await g.get(route("api.missions.chat",t.id));o.visit(route("messages",{chat_id:a.data.id}))},className:"w-full py-4 bg-primary-black text-white font-black rounded-full hover:bg-oflem-charcoal transition-all flex items-center justify-center gap-2",children:["ðŸ’¬ ",s("Message Performer")]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("p",{className:"text-xs text-gray-muted font-bold",children:"âš ï¸ Auto-validates in 72 hours if no action is taken"})})]}),t.status==="EN_COURS"&&d&&e.jsxs("section",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-[40px] p-8 md:p-12 shadow-lg border-2 border-green-400",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“¸"}),e.jsx("h2",{className:"text-3xl font-black text-primary-black mb-2",children:"Submit Proof of Completion"}),e.jsx("p",{className:"text-sm text-gray-muted font-bold",children:"Upload a photo and notes to show the customer you've completed the mission."})]}),e.jsx(D,{missionId:t.id,t:s})]}),t.status==="EN_VALIDATION"&&d&&e.jsx("section",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-[40px] p-8 md:p-12 shadow-lg border-2 border-blue-300",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"â³"}),e.jsx("h2",{className:"text-3xl font-black text-primary-black mb-2",children:"Awaiting Validation"}),e.jsx("p",{className:"text-sm text-gray-muted font-bold mb-6",children:"The customer is reviewing your work. You'll be notified once they validate."}),t.completion_proof_path&&e.jsxs("div",{className:"bg-white rounded-[24px] p-6 text-left",children:[e.jsx("h3",{className:"text-lg font-black text-primary-black mb-4",children:"Your Submission"}),e.jsx("img",{src:`/storage/${t.completion_proof_path}`,alt:"Your Proof",className:"w-full rounded-[16px] mb-4 shadow-md"}),t.completion_notes&&e.jsxs("p",{className:"text-sm text-gray-muted font-medium italic",children:['"',t.completion_notes,'"']})]})]})})]}),e.jsx("div",{className:"space-y-8",children:e.jsxs("section",{className:"bg-white rounded-[40px] p-8 shadow-sm border border-gray-border sticky top-8",children:[n&&t.status==="OUVERTE"&&e.jsxs("div",{className:"space-y-4 mb-6 pb-6 border-b border-gray-border",children:[e.jsxs(M,{href:route("missions.edit",t.id),className:"w-full py-4 bg-gold-accent text-primary-black font-black rounded-full hover:opacity-90 transition-all shadow-xl flex items-center justify-center gap-2",children:["âœï¸ ",s("Edit Mission")]}),e.jsxs("button",{onClick:()=>{confirm(s("Are you sure you want to cancel this mission?"))&&o.post(route("missions.update-status",t.id),{status:"ANNULEE"})},className:"w-full py-3 bg-red-100 text-red-700 font-black rounded-full hover:bg-red-200 transition-all text-sm",children:["âŒ ",s("Cancel Mission")]})]}),n&&t.status!=="OUVERTE"&&t.status!=="TERMINEE"&&t.status!=="ANNULEE"&&e.jsxs("div",{className:"space-y-4 mb-6 pb-6 border-b border-gray-border",children:[e.jsx("p",{className:"text-xs font-black text-gray-muted uppercase tracking-widest mb-3",children:s("Mission Management")}),(t.status==="EN_NEGOCIATION"||t.status==="VERROUILLEE")&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{confirm(s("Reopen this mission? This will clear the current assignment."))&&o.post(route("missions.update-status",t.id),{status:"OUVERTE"})},className:"w-full py-3 bg-blue-100 text-blue-700 font-black rounded-full hover:bg-blue-200 transition-all text-sm",children:["ðŸ”„ ",s("Reopen Mission")]}),e.jsxs("button",{onClick:()=>{confirm(s("Are you sure you want to cancel this mission?"))&&o.post(route("missions.update-status",t.id),{status:"ANNULEE"})},className:"w-full py-3 bg-red-100 text-red-700 font-black rounded-full hover:bg-red-200 transition-all text-sm",children:["âŒ ",s("Cancel Mission")]})]})]}),t.status==="EN_NEGOCIATION"?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ¤"}),e.jsx("h2",{className:"text-xl font-black text-primary-black mb-2",children:s("Negotiation Phase")}),e.jsx("p",{className:"text-sm text-gray-muted font-bold mb-6",children:s(n?"You have selected a performer. Confirm to reveal your address and move forward.":d?"Waiting for creators final confirmation...":"This mission is currently in negotiation.")}),n&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:()=>o.post(route("missions.confirm-assignment",t.id)),className:"w-full py-4 bg-gold-accent text-primary-black font-black rounded-full hover:opacity-90 transition-all shadow-xl",children:["âœ… ",s("Confirm Assignment")]}),x&&e.jsxs("button",{onClick:()=>m(!0),className:"w-full py-4 bg-green-500 text-white font-black rounded-full hover:bg-green-600 transition-all shadow-xl flex items-center justify-center gap-2",children:["ðŸ’³ ",s("Complete Payment Hold")]}),e.jsxs("button",{onClick:async()=>{const a=await g.get(route("api.missions.chat",t.id));o.visit(route("messages",{chat_id:a.data.id}))},className:"w-full py-4 bg-primary-black text-white font-black rounded-full hover:bg-oflem-charcoal transition-all flex items-center justify-center gap-2",children:["ðŸ’¬ ",s("Message Performer")]})]}),d&&t.assigned_user_id&&e.jsxs("button",{onClick:async()=>{const a=await g.get(route("api.missions.chat",t.id));o.visit(route("messages",{chat_id:a.data.id}))},className:"w-full py-4 bg-primary-black text-white font-black rounded-full hover:bg-black transition-all flex items-center justify-center gap-2",children:["ðŸ’¬ ",s("Message Creator")]})]}):t.status==="VERROUILLEE"?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸŽ‰"}),e.jsx("h2",{className:"text-xl font-black text-primary-black mb-2",children:s(d?"Mission Assigned to You!":"Mission Booked")}),e.jsx("p",{className:"text-sm text-gray-muted font-bold mb-6",children:s(d?"You can now see the exact address and start the mission.":"This mission has already been assigned.")}),d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:()=>o.post(route("missions.start-work",t.id)),className:"w-full py-4 bg-gold-accent text-primary-black font-black rounded-full hover:opacity-90 transition-all shadow-xl",children:["ðŸ”¨ ",s("Start Work Now")]}),e.jsxs("button",{onClick:async()=>{const a=await g.get(route("api.missions.chat",t.id));o.visit(route("messages",{chat_id:a.data.id}))},className:"w-full py-4 bg-primary-black text-white font-black rounded-full hover:bg-oflem-charcoal transition-all flex items-center justify-center gap-2",children:["ðŸ’¬ ",s("Message Creator")]})]}),n&&e.jsxs("button",{onClick:async()=>{const a=await g.get(route("api.missions.chat",t.id));o.visit(route("messages",{chat_id:a.data.id}))},className:"w-full py-4 bg-primary-black text-white font-black rounded-full hover:bg-oflem-charcoal transition-all flex items-center justify-center gap-2",children:["ðŸ’¬ ",s("Message Performer")]})]}):t.status==="EN_COURS"?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸš€"}),e.jsx("h2",{className:"text-xl font-black text-primary-black mb-2",children:s("Work In Progress")}),e.jsx("p",{className:"text-sm text-gray-muted font-bold mb-6",children:s(d?"Finish the task and upload proof!":"The performer is currently working.")}),e.jsxs("button",{onClick:async()=>{const a=await g.get(route("api.missions.chat",t.id));o.visit(route("messages",{chat_id:a.data.id}))},className:"w-full py-4 bg-primary-black text-white font-black rounded-full hover:bg-oflem-charcoal transition-all flex items-center justify-center gap-2",children:["ðŸ’¬ ",s(n?"Message Performer":"Message Creator")]})]}):n?e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:"text-xl font-black text-primary-black mb-6",children:["ðŸ¤ ",s("Offers")]}),e.jsx("div",{className:"space-y-6",children:t.offers.length>0?t.offers.map(a=>e.jsxs("div",{className:"p-5 bg-oflem-cream rounded-[24px] border border-gray-border",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-black text-primary-black",children:a.user.name}),e.jsx("p",{className:"text-xs text-gray-muted font-bold",children:"â˜… 5.0 (New)"})]}),e.jsxs("p",{className:"text-lg font-black text-gold-accent",children:["CHF ",a.amount]})]}),e.jsx("p",{className:"text-xs text-gray-muted font-medium mb-6 line-clamp-2",children:a.message}),t.status==="OUVERTE"&&e.jsxs("button",{onClick:()=>{o.post(route("missions.select-offer",{mission:t.id,offer:a.id}),{},{onSuccess:f=>{f.props.flash?.stripe_client_secret&&(u(f.props.flash.stripe_client_secret),m(!0))}})},className:"w-full py-3 bg-primary-black text-white font-black rounded-full hover:bg-black transition-all text-sm shadow-md",children:["ðŸ’¼ ",s("Hire")," ",a.user.name]}),a.status==="accepted"&&e.jsx("div",{className:"text-center py-2 bg-gold-accent text-primary-black font-black text-[10px] uppercase rounded-full",children:s("Selected")})]},a.id)):e.jsx("p",{className:"text-gray-muted font-bold text-center text-sm",children:s("Waiting for offers...")})})]}):!n&&t.status==="OUVERTE"&&e.jsxs("div",{className:"space-y-8",children:[t.price_type==="fixed"&&e.jsxs("div",{className:"space-y-6 pb-6 border-b border-gray-border",children:[e.jsxs("div",{className:"text-center pb-6 border-b border-gray-border",children:[e.jsx("p",{className:"text-xs font-black text-gray-muted uppercase tracking-widest mb-1",children:s("Fixed Price")}),e.jsxs("p",{className:"text-4xl font-black text-primary-black",children:["CHF ",t.budget]})]}),e.jsxs("button",{onClick:()=>{confirm(s("Are you sure you want to accept this mission? You will be committing to complete it for the fixed price shown."))&&C()},className:"w-full py-5 bg-primary-black text-white font-black rounded-full hover:bg-black transition-all shadow-xl text-lg",children:["âš¡ ",s("Accept Instantly")]}),e.jsx("p",{className:"text-[10px] text-gray-muted font-bold text-center leading-relaxed",children:s("By accepting, you commit to completing this mission for the fixed price shown.")})]}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-black text-primary-black mb-4",children:t.price_type==="fixed"?s("Or Propose your Price"):`ðŸ·ï¸ ${s("Submit an Offer")}`}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"amount",value:s("Your price"),className:"text-xs uppercase tracking-widest font-black mb-3"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{id:"amount",type:"number",className:"w-full pl-12",placeholder:"0.00",value:r.data.amount,onChange:a=>r.setData("amount",a.target.value),required:!0}),e.jsx("span",{className:"absolute left-5 top-1/2 -translate-y-1/2 font-black text-gray-muted",children:"CHF"})]}),e.jsx(k,{message:r.errors.amount,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"message",value:s("Message (Optional)"),className:"text-xs uppercase tracking-widest font-black mb-3"}),e.jsx("textarea",{id:"message",className:"w-full bg-oflem-cream border-gray-border rounded-[24px] p-5 text-sm font-medium focus:border-gold-accent focus:ring-0 min-h-[100px]",placeholder:s("Tell the creator why you are a good fit..."),value:r.data.message,onChange:a=>r.setData("message",a.target.value)}),e.jsx(k,{message:r.errors.message,className:"mt-2"})]}),e.jsxs("button",{type:"submit",disabled:r.processing,className:"w-full py-5 bg-gold-accent text-primary-black font-black rounded-full hover:opacity-90 transition-all shadow-xl text-lg",children:["ðŸš€ ",s("Send Offer")]})]})]})]})})]}),n&&t.status==="OUVERTE"&&e.jsx("div",{className:"mt-8",children:e.jsx(R,{mission:t,t:s})})]}),e.jsx(P,{show:p,clientSecret:x,onClose:()=>m(!1),onSuccess:()=>{m(!1),i?.chat_id?o.visit(route("messages",{chat_id:i.chat_id})):o.reload()}})]})}function D({missionId:t,t:l}){const{data:s,setData:c,post:i,processing:n,errors:d,progress:x}=N({completion_proof:null,completion_notes:""}),[u,p]=b.useState(null),m=h=>{const j=h.target.files[0];j&&(c("completion_proof",j),p(URL.createObjectURL(j)))},r=h=>{h.preventDefault(),i(route("missions.submit-validation",t),{forceFormData:!0,onSuccess:()=>{p(null)}})};return e.jsxs("form",{onSubmit:r,className:"space-y-6 bg-white rounded-[24px] p-6",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"completion_proof",value:l("Upload Photo Proof"),className:"text-xs uppercase tracking-widest font-black mb-3"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"file",id:"completion_proof",accept:"image/jpeg,image/png,image/jpg,image/webp",onChange:m,className:`block w-full text-sm text-gray-muted font-medium\r
                            file:mr-4 file:py-3 file:px-6\r
                            file:rounded-full file:border-0\r
                            file:text-sm file:font-black\r
                            file:bg-primary-black file:text-white\r
                            hover:file:bg-black file:cursor-pointer\r
                            cursor-pointer`,required:!0})}),e.jsx(k,{message:d.completion_proof,className:"mt-2"}),u&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:u,alt:"Preview",className:"w-full max-h-64 object-cover rounded-[16px] shadow-md"})})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"completion_notes",value:l("Completion Notes (Optional)"),className:"text-xs uppercase tracking-widest font-black mb-3"}),e.jsx("textarea",{id:"completion_notes",value:s.completion_notes,onChange:h=>c("completion_notes",h.target.value),className:"w-full bg-oflem-cream border-gray-border rounded-[24px] p-5 text-sm font-medium focus:border-gold-accent focus:ring-0 min-h-[120px]",placeholder:l("Describe what you completed, any additional details..."),maxLength:1e3}),e.jsx(k,{message:d.completion_notes,className:"mt-2"}),e.jsxs("p",{className:"text-xs text-gray-muted font-bold mt-2",children:[s.completion_notes.length,"/1000 characters"]})]}),x&&e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-green-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${x.percentage}%`}})}),e.jsx("button",{type:"submit",disabled:n||!s.completion_proof,className:"w-full py-5 bg-green-600 text-white font-black rounded-full hover:bg-green-700 transition-all shadow-xl text-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:n?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l("Uploading...")]}):e.jsxs(e.Fragment,{children:["âœ… ",l("Submit for Validation")]})}),e.jsxs("p",{className:"text-xs text-gray-muted font-bold text-center",children:["âš ï¸ ",l("The customer will have 72 hours to validate your work")]})]})}function U({missionId:t,questionId:l,t:s}){const{data:c,setData:i,post:n,processing:d,reset:x}=N({answer:""}),u=p=>{p.preventDefault(),n(route("missions.answer-question",{mission:t,question:l}),{onSuccess:()=>x()})};return e.jsxs("form",{onSubmit:u,className:"ml-12 mt-2 flex gap-4",children:[e.jsx(_,{value:c.answer,onChange:p=>i("answer",p.target.value),placeholder:s("Type your answer..."),className:"flex-1 !py-2 !px-4 !text-xs",required:!0}),e.jsx("button",{type:"submit",disabled:d,className:"px-6 py-2 bg-gold-accent text-primary-black font-black rounded-full hover:opacity-90 transition-all text-[10px] uppercase tracking-widest disabled:opacity-50",children:s("Answer")})]})}function w({icon:t,label:l,value:s,subValue:c}){return e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("span",{className:"text-2xl mt-1",children:t}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-muted uppercase tracking-widest mb-1",children:l}),e.jsx("p",{className:"font-black text-primary-black",children:s}),c&&e.jsx("p",{className:"text-[10px] font-bold text-gold-accent mt-1 italic",children:c})]})]})}export{X as default};
