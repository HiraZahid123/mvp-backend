import{a as i,u as b,j as t,H as D,r as S}from"./app-B-8gU7sK.js";import{A as w}from"./AuthSplitLayout-C7dhZVfK.js";import{I}from"./InputError-D1oEaz7A.js";import{P as R}from"./PrimaryButton-CY4bAbmZ.js";import{u as $}from"./useTranslation-BlOXshqE.js";function K({email:c}){const[a,m]=i.useState(["","","","","",""]),[l,u]=i.useState(30),[y,f]=i.useState(!1),{t:o}=$(),{data:B,setData:p,post:L,processing:x,errors:j}=b({email:c,code:""}),{post:v,processing:g}=b({email:c});i.useEffect(()=>{if(l===0){f(!0);return}const s=setTimeout(()=>{u(l-1)},1e3);return()=>clearTimeout(s)},[l]);const N=(s,e)=>{if(!/^\d*$/.test(e))return;const n=[...a];n[s]=e.slice(-1),m(n),e&&s<5&&document.getElementById(`code-${s+1}`)?.focus();const r=n.join("");r.length===6&&(p("code",r),d(r))},C=(s,e)=>{e.key==="Backspace"&&!a[s]&&s>0&&document.getElementById(`code-${s-1}`)?.focus()},E=s=>{s.preventDefault();const e=s.clipboardData.getData("text").slice(0,6);if(!/^\d+$/.test(e))return;const n=[...a];if(e.split("").forEach((r,h)=>{h<6&&(n[h]=r)}),m(n),e.length===6)p("code",e),d(e);else{const r=e.length;r<6&&document.getElementById(`code-${r}`)?.focus()}},d=(s=null)=>{const e=s||a.join("");e.length===6&&S.post(route("auth.verify-email-code.store"),{email:c,code:e},{preserveState:!1,onSuccess:()=>{},onError:n=>{console.error("Verification failed:",n)}})},k=()=>{v(route("auth.verify-email-code.resend"),{onSuccess:()=>{u(30),f(!1)}})};return t.jsxs(w,{heroImage:"/images/illustrations/verify-email.svg",bgAccentClass:"bg-cream-accent",children:[t.jsx(D,{title:o("Vérifier l'email")}),t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("h1",{className:"text-[32px] lg:text-[40px] font-serif font-bold text-primary-black tracking-tight mb-3 leading-tight",children:o("Vérifiez votre email")}),t.jsxs("p",{className:"text-gray-muted text-base font-medium",children:[o("Nous avons envoyé un code à "),t.jsx("span",{className:"font-bold text-primary-black",children:c})]})]}),t.jsxs("form",{onSubmit:s=>{s.preventDefault(),d()},className:"space-y-8",children:[t.jsxs("div",{children:[t.jsx("div",{className:"flex justify-center gap-2 lg:gap-3",children:a.map((s,e)=>t.jsx("input",{id:`code-${e}`,type:"text",inputMode:"numeric",maxLength:1,value:s,onChange:n=>N(e,n.target.value),onKeyDown:n=>C(e,n),onPaste:E,className:`\r
                                    w-12 h-14 lg:w-14 lg:h-16\r
                                    text-center text-2xl font-bold\r
                                    bg-input-bg border-2 border-gray-border/50\r
                                    rounded-[16px]\r
                                    text-primary-black\r
                                    focus:outline-none focus:ring-2 focus:ring-gold-accent/30 focus:border-gold-accent\r
                                    transition-all duration-200\r
                                `},e))}),t.jsx(I,{message:j.code,className:"mt-3 text-center"})]}),t.jsx("div",{className:"text-center",children:y?t.jsx("button",{type:"button",onClick:k,disabled:g,className:"text-sm font-bold text-gold-accent hover:underline disabled:opacity-50",children:o(g?"Envoi...":"Renvoyer le code")}):t.jsxs("p",{className:"text-sm text-gray-muted font-medium",children:[o("Renvoyer le code dans "),t.jsxs("span",{className:"font-bold text-primary-black",children:[l,"s"]})]})}),t.jsx(R,{className:"w-full",disabled:x||a.join("").length!==6,processing:x,children:o("Vérifier")})]}),t.jsx("div",{className:"mt-6 p-4 bg-gold-accent/5 rounded-[24px] border border-gold-accent/20",children:t.jsxs("p",{className:"text-xs text-gray-muted text-center",children:[o("Le code expirera dans "),t.jsx("span",{className:"font-bold text-primary-black",children:o("10 minutes")})]})})]})}export{K as default};
