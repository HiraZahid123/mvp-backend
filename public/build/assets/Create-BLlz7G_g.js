import{r as l,j as e,a as H,u as R,H as L,b as E,c as D}from"./app-3ui6Zh4V.js";import{u as P}from"./useTranslation-C36Wy86N.js";import{H as T,F as W}from"./Footer-D7fuymOK.js";import{T as A}from"./TextInput-CneGO9cV.js";import{I as x}from"./InputLabel-uIPqz4u5.js";import{I as f}from"./InputError-dyO9oETY.js";import{u as G,A as O,G as $,M as q}from"./esm-BO4OLmwt.js";import{F as z}from"./MapPinIcon-CthXvUFP.js";import"./LanguageSwitcher-Ct-b8yFw.js";function B({title:p,titleId:d,...s},m){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":d},s),p?l.createElement("title",{id:d},p):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const K=l.forwardRef(B),U=["places"];function Y({onLocationSelect:p,initialLocation:d=null,initialAddress:s=""}){const{t:m}=P(),[b,v]=l.useState(d),[u,g]=l.useState(s),[N,j]=l.useState(d||{lat:46.8182,lng:8.2275}),[a,i]=l.useState(null),{isLoaded:k,loadError:h}=G({googleMapsApiKey:"AIzaSyAaeyO3ffYCdUpAHU0kQx3TsHGhlbaIgkA",libraries:U}),c=l.useCallback((r,n)=>{window.google&&window.google.maps&&new window.google.maps.Geocoder().geocode({location:{lat:r,lng:n}},(o,I)=>{if(I==="OK"&&o[0]){const S=o[0].formatted_address;g(S);let M="";for(const F of o[0].address_components)if(F.types.includes("locality")){M=F.long_name;break}p({lat:r,lng:n,address:S,city:M||S.split(",")[0]})}})},[p]),_=l.useCallback(r=>{const n=r.latLng.lat(),t=r.latLng.lng();v({lat:n,lng:t}),c(n,t)},[c]),C=r=>{i(r)},y=()=>{if(a!==null){const r=a.getPlace();if(r.geometry){const n={lat:r.geometry.location.lat(),lng:r.geometry.location.lng()};v(n),j(n),g(r.formatted_address);let t="";if(r.address_components){for(const o of r.address_components)if(o.types.includes("locality")){t=o.long_name;break}}p({lat:n.lat,lng:n.lng,address:r.formatted_address,city:t||r.formatted_address.split(",")[0]})}}},w={width:"100%",height:"300px",borderRadius:"24px"};return h?e.jsx("div",{className:"p-4 bg-red-50 text-red-500 rounded-[24px]",children:m("Error loading Google Maps")}):k?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute left-5 top-1/2 -translate-y-1/2 text-gray-muted group-focus-within:text-gold-accent transition-colors",children:e.jsx(K,{className:"w-5 h-5"})}),e.jsx(O,{onLoad:C,onPlaceChanged:y,options:{componentRestrictions:{country:"ch"}},children:e.jsx("input",{type:"text",placeholder:m("Search for a location..."),className:"w-full pl-14 pr-6 py-4 bg-off-white-bg border-gray-border rounded-full text-sm font-bold focus:border-gold-accent focus:ring-0 transition-all shadow-sm",value:u,onChange:r=>g(r.target.value),onKeyDown:r=>r.key==="Enter"&&r.preventDefault()})})]}),e.jsx("div",{className:"rounded-[24px] overflow-hidden border border-gray-border shadow-sm",children:e.jsx($,{mapContainerStyle:w,center:N,zoom:b?15:8,onClick:_,options:{disableDefaultUI:!0,zoomControl:!0,styles:[{featureType:"all",elementType:"geometry",stylers:[{color:"#f5f5f5"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#e9e9e9"}]}]},children:b&&e.jsx(q,{position:b,animation:window.google.maps.Animation.DROP})})}),b&&e.jsxs("div",{className:"flex items-center gap-2 p-4 bg-gold-accent/5 rounded-[20px] border border-gold-accent/10",children:[e.jsx(z,{className:"w-5 h-5 text-gold-accent flex-shrink-0"}),e.jsx("p",{className:"text-xs font-bold text-gray-muted truncate",children:u})]})]}):e.jsx("div",{className:"h-[300px] w-full bg-gray-100 animate-pulse rounded-[24px] flex items-center justify-center text-gray-400 font-bold",children:m("Loading maps...")})}function re({prefillTitle:p="",aiTitle:d=null}){const{t:s}=P(),{auth:m}=H().props,[b,v]=l.useState(!1),[u,g]=l.useState(!1),[N,j]=l.useState(""),{data:a,setData:i,post:k,processing:h,errors:c,reset:_}=R({title:d||p,description:"",location:"",lat:"",lng:"",exact_address:"",date_time:"",budget:"",price_type:"fixed",additional_details:""}),C=async t=>{g(!0),j("");try{return(await E.post(route("moderation.check"),{content:t})).data.is_clean?!0:(j(s("Content violates moderation rules.")),!1)}catch{return!0}finally{g(!1)}},[y,w]=l.useState(!1),r=async()=>{if(a.title){w(!0);try{const t=await E.post(route("missions.ai-rewrite"),{title:a.title,description:a.description});i(o=>({...o,title:t.data.improved_title,description:t.data.improved_description}))}catch{}finally{w(!1)}}},n=async t=>{if(t.preventDefault(),!!await C(a.title+" "+a.description)){if(!m.user){D.post(route("missions.store"),a);return}k(route("missions.store"),{onSuccess:()=>_()})}};return e.jsxs("div",{className:"min-h-screen bg-off-white-bg font-sans",children:[e.jsx(L,{title:s("Create Mission")}),e.jsx(T,{}),e.jsx("main",{className:"max-w-3xl mx-auto py-16 px-6",children:e.jsxs("div",{className:"bg-white rounded-[40px] p-8 md:p-12 shadow-sm border border-gray-border",children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsx("h1",{className:"text-3xl font-black text-primary-black mb-3",children:s("Create your mission")}),e.jsx("p",{className:"text-gray-muted font-bold",children:s("We take care of the rest.")})]}),e.jsxs("form",{onSubmit:n,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx(x,{htmlFor:"title",value:s("Mission title"),className:"text-xs uppercase tracking-widest font-black"}),d&&a.title===d&&e.jsxs("span",{className:"text-[10px] font-black text-green-500 uppercase tracking-widest flex items-center gap-1 animate-pulse",children:["âœ¨ ",s("AI Comprehensive Title")]})]}),e.jsx(A,{id:"title",type:"text",value:a.title,className:"w-full",onChange:t=>i("title",t.target.value),placeholder:s("e.g. Need help moving a sofa"),required:!0}),e.jsx(f,{message:c.title||N,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx(x,{htmlFor:"description",value:s("Description"),className:"text-xs uppercase tracking-widest font-black"}),e.jsxs("button",{type:"button",onClick:r,disabled:y,className:"text-[10px] font-black text-gold-accent uppercase tracking-widest hover:underline disabled:opacity-50 flex items-center gap-2",children:[y&&e.jsx("span",{className:"w-3 h-3 border-2 border-gold-accent border-t-transparent rounded-full animate-spin"}),"âœ¨ ",s(y?"Writing...":"Help me write")]})]}),e.jsx("textarea",{id:"description",value:a.description,className:"w-full bg-off-white-bg border-gray-border rounded-[24px] p-5 text-sm font-medium focus:border-gold-accent focus:ring-0 min-h-[150px] transition-all",onChange:t=>i("description",t.target.value),placeholder:s("Provide more details about your mission...")}),e.jsx(f,{message:c.description,className:"mt-2"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(x,{value:s("Where will this happen ?"),className:"text-xs uppercase tracking-widest font-black"}),e.jsx("span",{className:"px-2 py-0.5 bg-cream-accent text-[9px] font-black uppercase tracking-tighter rounded-full",children:s("Publicly Visible")})]}),e.jsx(Y,{onLocationSelect:t=>{i(o=>({...o,location:t.city,lat:t.lat,lng:t.lng,exact_address:t.address}))},initialAddress:a.exact_address||a.location}),e.jsx(f,{message:c.location||c.lat||c.lng,className:"mt-2"}),e.jsxs("p",{className:"mt-2 text-[10px] text-gray-muted font-bold",children:["ðŸ“ ",s("Pick the exact spot on the map or search for an address.")]})]}),e.jsxs("div",{className:"col-span-2 md:col-span-1",children:[e.jsx(x,{htmlFor:"date_time",value:s("Date & Time"),className:"text-xs uppercase tracking-widest font-black mb-3"}),e.jsx(A,{id:"date_time",type:"datetime-local",value:a.date_time,className:"w-full",onChange:t=>i("date_time",t.target.value)}),e.jsx(f,{message:c.date_time,className:"mt-2"})]})]}),e.jsxs("div",{className:"bg-off-white-bg p-8 rounded-[32px] border border-gray-border",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(x,{value:s("Pricing & Budget"),className:"text-xs uppercase tracking-widest font-black mb-2"}),e.jsx("p",{className:"text-[10px] text-gray-muted font-bold uppercase tracking-wider",children:s("Choose how you want to pay for this mission")})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-8",children:[e.jsxs("button",{type:"button",onClick:()=>i("price_type","fixed"),className:`p-6 rounded-[24px] border-2 transition-all text-left relative overflow-hidden group ${a.price_type==="fixed"?"border-primary-black bg-white shadow-md":"border-transparent bg-gray-100/50 opacity-60 hover:opacity-100"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"text-2xl",children:"âš¡"}),a.price_type==="fixed"&&e.jsx("div",{className:"w-2 h-2 bg-primary-black rounded-full"})]}),e.jsx("p",{className:"font-black text-primary-black mb-1",children:s("Fixed Price")}),e.jsx("p",{className:"text-[10px] text-gray-muted font-bold leading-tight",children:s("Set your budget. Performers will accept it instantly.")})]}),e.jsxs("button",{type:"button",onClick:()=>i("price_type","open"),className:`p-6 rounded-[24px] border-2 transition-all text-left relative overflow-hidden group ${a.price_type==="open"?"border-primary-black bg-white shadow-md":"border-transparent bg-gray-100/50 opacity-60 hover:opacity-100"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"text-2xl",children:"ðŸ·ï¸"}),a.price_type==="open"&&e.jsx("div",{className:"w-2 h-2 bg-primary-black rounded-full"})]}),e.jsx("p",{className:"font-black text-primary-black mb-1",children:s("Request Quotes")}),e.jsx("p",{className:"text-[10px] text-gray-muted font-bold leading-tight",children:s("Receive offers from performers and negotiate the price.")})]})]}),e.jsxs("div",{className:"max-w-xs mx-auto text-center",children:[e.jsx(x,{htmlFor:"budget",value:a.price_type==="fixed"?s("Your Price"):s("Expected Budget (Optional)"),className:"text-[10px] uppercase tracking-widest font-black mb-4"}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("input",{id:"budget",type:"number",value:a.budget,className:"w-full bg-white border-2 border-gray-border rounded-[20px] py-4 pl-16 pr-6 text-xl font-black text-primary-black focus:border-gold-accent focus:ring-0 transition-all text-center",onChange:t=>i("budget",t.target.value),placeholder:"0",required:a.price_type==="fixed"}),e.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 font-black text-gray-muted text-sm",children:"CHF"})]}),a.price_type==="fixed"&&e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:[20,50,100,200].map(t=>e.jsxs("button",{type:"button",onClick:()=>i("budget",t.toString()),className:`px-4 py-2 rounded-full text-[10px] font-black transition-all border-2 ${a.budget===t.toString()?"border-gold-accent bg-gold-accent text-white":"border-gray-border bg-white text-gray-muted hover:border-gold-accent/50"}`,children:[t," CHF"]},t))}),e.jsx(f,{message:c.budget,className:"mt-4"})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(x,{htmlFor:"exact_address",value:s("Refine Exact Address"),className:"text-xs uppercase tracking-widest font-black"}),e.jsx("span",{className:"px-2 py-0.5 bg-gold-accent text-[9px] font-black uppercase tracking-tighter rounded-full",children:s("Private")})]}),e.jsx(A,{id:"exact_address",type:"text",value:a.exact_address,className:"w-full",onChange:t=>i("exact_address",t.target.value),placeholder:s("Street name, house number, apartment...")}),e.jsxs("p",{className:"mt-2 text-[10px] text-gray-muted font-bold flex items-center gap-1",children:["ðŸ”’ ",s("Automatically filled from map. You can add details like room or floor.")]}),e.jsx(f,{message:c.exact_address,className:"mt-2"})]}),e.jsx("div",{className:"pt-6",children:e.jsx("button",{type:"submit",disabled:h||u||!a.title.trim(),className:`w-full py-5 font-black rounded-full transition-all shadow-xl text-lg flex items-center justify-center gap-3 active:scale-[0.98] ${!a.title.trim()||h||u?"bg-gray-200 text-gray-400 cursor-not-allowed shadow-none":"bg-primary-black text-white hover:bg-black"}`,children:h||u?e.jsx("span",{className:"w-6 h-6 border-4 border-gold-accent border-t-white rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:["ðŸš€ ",s("Submit Mission")]})})})]})]})}),e.jsx(W,{})]})}export{re as default};
