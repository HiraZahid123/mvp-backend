import{a as o,j as e,b as L,r as W,L as c}from"./app-Dk__5EGU.js";import{u as M}from"./useTranslation-B8cbwYpv.js";import{L as O}from"./LanguageSwitcher-kqEQMpS1.js";import{M as I,i as A,u as T,P as q,a as X,b as U,L as G,m as K}from"./proxy-CG6XEhYQ.js";function P(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function Y(...t){return s=>{let r=!1;const a=t.map(n=>{const m=P(n,s);return!r&&typeof m=="function"&&(r=!0),m});if(r)return()=>{for(let n=0;n<a.length;n++){const m=a[n];typeof m=="function"?m():P(t[n],null)}}}}function B(...t){return o.useCallback(Y(...t),t)}class V extends o.Component{getSnapshotBeforeUpdate(s){const r=this.props.childRef.current;if(r&&s.isPresent&&!this.props.isPresent){const a=r.offsetParent,n=A(a)&&a.offsetWidth||0,m=A(a)&&a.offsetHeight||0,i=this.props.sizeRef.current;i.height=r.offsetHeight||0,i.width=r.offsetWidth||0,i.top=r.offsetTop,i.left=r.offsetLeft,i.right=n-i.width-i.left,i.bottom=m-i.height-i.top}return null}componentDidUpdate(){}render(){return this.props.children}}function Q({children:t,isPresent:s,anchorX:r,anchorY:a,root:n}){const m=o.useId(),i=o.useRef(null),y=o.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:p}=o.useContext(I),v=t.props?.ref??t?.ref,f=B(i,v);return o.useInsertionEffect(()=>{const{width:l,height:d,top:x,left:g,right:j,bottom:w}=y.current;if(s||!i.current||!l||!d)return;const C=r==="left"?`left: ${g}`:`right: ${j}`,_=a==="bottom"?`bottom: ${w}`:`top: ${x}`;i.current.dataset.motionPopId=m;const N=document.createElement("style");p&&(N.nonce=p);const u=n??document.head;return u.appendChild(N),N.sheet&&N.sheet.insertRule(`
          [data-motion-pop-id="${m}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${d}px !important;
            ${C}px !important;
            ${_}px !important;
          }
        `),()=>{u.contains(N)&&u.removeChild(N)}},[s]),e.jsx(V,{isPresent:s,childRef:i,sizeRef:y,children:o.cloneElement(t,{ref:f})})}const J=({children:t,initial:s,isPresent:r,onExitComplete:a,custom:n,presenceAffectsLayout:m,mode:i,anchorX:y,anchorY:p,root:v})=>{const f=T(Z),l=o.useId();let d=!0,x=o.useMemo(()=>(d=!1,{id:l,initial:s,isPresent:r,custom:n,onExitComplete:g=>{f.set(g,!0);for(const j of f.values())if(!j)return;a&&a()},register:g=>(f.set(g,!1),()=>f.delete(g))}),[r,f,a]);return m&&d&&(x={...x}),o.useMemo(()=>{f.forEach((g,j)=>f.set(j,!1))},[r]),o.useEffect(()=>{!r&&!f.size&&a&&a()},[r]),i==="popLayout"&&(t=e.jsx(Q,{isPresent:r,anchorX:y,anchorY:p,root:v,children:t})),e.jsx(q.Provider,{value:x,children:t})};function Z(){return new Map}const R=t=>t.key||"";function H(t){const s=[];return o.Children.forEach(t,r=>{o.isValidElement(r)&&s.push(r)}),s}const ee=({children:t,custom:s,initial:r=!0,onExitComplete:a,presenceAffectsLayout:n=!0,mode:m="sync",propagate:i=!1,anchorX:y="left",anchorY:p="top",root:v})=>{const[f,l]=X(i),d=o.useMemo(()=>H(t),[t]),x=i&&!f?[]:d.map(R),g=o.useRef(!0),j=o.useRef(d),w=T(()=>new Map),C=o.useRef(new Set),[_,N]=o.useState(d),[u,$]=o.useState(d);U(()=>{g.current=!1,j.current=d;for(let b=0;b<u.length;b++){const h=R(u[b]);x.includes(h)?(w.delete(h),C.current.delete(h)):w.get(h)!==!0&&w.set(h,!1)}},[u,x.length,x.join("-")]);const E=[];if(d!==_){let b=[...d];for(let h=0;h<u.length;h++){const k=u[h],S=R(k);x.includes(S)||(b.splice(h,0,k),E.push(k))}return m==="wait"&&E.length&&(b=E),$(H(b)),N(d),null}const{forceRender:z}=o.useContext(G);return e.jsx(e.Fragment,{children:u.map(b=>{const h=R(b),k=i&&!f?!1:d===u||x.includes(h),S=()=>{if(C.current.has(h))return;if(C.current.add(h),w.has(h))w.set(h,!0);else return;let F=!0;w.forEach(D=>{D||(F=!1)}),F&&(z?.(),$(j.current),i&&l?.(),a&&a())};return e.jsx(J,{isPresent:k,initial:!g.current||r?void 0:!1,custom:s,presenceAffectsLayout:n,mode:m,root:v,onExitComplete:k?void 0:S,anchorX:y,anchorY:p,children:b},h)})})};function te(){const{t}=M(),{auth:s}=L().props,[r,a]=o.useState(!1),[n,m]=o.useState([]),[i,y]=o.useState(!1),p=s.unread_notifications_count||0;o.useEffect(()=>{r&&(f(),v())},[r]);const v=async()=>{try{await fetch(route("notifications.mark-all-read"),{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")}}),W.reload({only:["auth"]})}catch(l){console.error("Failed to mark notifications as read",l)}},f=async()=>{y(!0);try{const d=await(await fetch(route("notifications.index"),{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}})).json();m(d.notifications.data.slice(0,5))}catch(l){console.error("Failed to fetch notifications",l)}finally{y(!1)}};return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>a(!r),className:"relative p-2 text-gray-muted hover:text-oflem-charcoal transition-colors focus:outline-none",children:[e.jsx("span",{className:"text-xl",children:"üîî"}),p>0&&e.jsx("span",{className:"absolute top-1 right-1 bg-oflem-terracotta text-white text-[10px] font-black w-4 h-4 rounded-full flex items-center justify-center border-2 border-oflem-cream",children:p>9?"9+":p})]}),e.jsx(ee,{children:r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>a(!1)}),e.jsxs(K.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},className:"absolute right-0 mt-2 w-80 bg-white rounded-2xl shadow-xl border border-gray-border overflow-hidden z-50 origin-top-right",children:[e.jsxs("div",{className:"p-4 border-b border-gray-border/50 flex items-center justify-between",children:[e.jsx("h3",{className:"font-black text-sm text-oflem-charcoal",children:t("Notifications")}),e.jsx(c,{href:route("notifications.index"),className:"text-[10px] font-black uppercase text-oflem-terracotta hover:underline",onClick:()=>a(!1),children:t("See all")})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:i?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin inline-block w-6 h-6 border-2 border-oflem-terracotta border-t-transparent rounded-full mb-2"}),e.jsx("p",{className:"text-xs font-bold text-gray-muted",children:t("Loading...")})]}):n.length>0?n.map(l=>{let d=route("notifications.index");return l.data.mission_id&&(d=route("missions.show",l.data.mission_id)),l.data.chat_id&&(d=route("messages",{chat_id:l.data.chat_id})),e.jsx(c,{href:d,onClick:()=>a(!1),className:`block p-4 border-b border-gray-border/30 hover:bg-oflem-cream/30 transition-colors ${l.read_at?"":"bg-oflem-cream/10"}`,children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"text-lg",children:l.data.type==="nearby_mission"?"üìç":l.data.type==="offer_rejected"?"‚ùå":l.data.type==="new_question"?"‚ùì":l.data.type==="new_message"?"‚úâÔ∏è":l.data.type==="mission_assigned"?"üéä":"üîî"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-bold text-oflem-charcoal mb-1",children:l.data.message||l.data.preview||t("You have a new notification")}),e.jsx("p",{className:"text-[10px] text-gray-muted font-medium",children:new Date(l.created_at).toLocaleDateString()})]})]})},l.id)}):e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-xs font-bold text-gray-muted",children:t("No notifications yet")})})})]})]})})]})}function se(){const t=o.useRef(null),{auth:s}=L().props,r=s?.notification_preferences?.sound_enabled??!0;return o.useEffect(()=>(t.current||(t.current=new Audio("/sounds/notification.mp3"),t.current.volume=.5,t.current.load()),()=>{t.current&&(t.current.pause(),t.current=null)}),[]),{playSound:()=>{r&&t.current&&(t.current.currentTime=0,t.current.play().catch(n=>{console.debug("Notification sound blocked by browser:",n.message)}))},soundEnabled:r}}function ie(){const{t}=M(),{auth:s}=L().props,r=s.user?.last_selected_role||s.user?.role_type||"guest",{playSound:a}=se();o.useEffect(()=>{if(s.user&&window.Echo)return window.Echo.private(`App.Models.User.${s.user.id}`).notification(i=>{console.log("New notification received:",i),a(),W.reload({only:["auth"]})}),()=>{window.Echo.leave(`App.Models.User.${s.user.id}`)}},[s.user?.id,a]);const n=typeof window<"u"&&window.location.pathname.startsWith("/admin");return e.jsxs("nav",{className:"w-full bg-oflem-cream border-b border-gray-border/50 px-4 md:px-6 py-4 flex items-center justify-between sticky top-0 z-50 backdrop-blur-md bg-oflem-cream/90",children:[e.jsxs("div",{className:"flex items-center gap-6 md:gap-12",children:[e.jsxs(c,{href:"/",className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg md:text-xl font-black text-oflem-charcoal tracking-tight uppercase",children:"OFLEM"}),s.user?.admin_role&&n&&e.jsx("span",{className:"text-xs bg-oflem-terracotta text-white px-2 py-1 rounded-full font-bold",children:"ADMIN"})]}),s.user?.admin_role&&n?e.jsxs("div",{className:"hidden lg:flex items-center gap-2",children:[e.jsxs(c,{href:"/admin/dashboard",className:`px-4 py-2 rounded-xl font-bold text-sm transition-all ${window.location.pathname==="/admin/dashboard"?"bg-oflem-terracotta text-white":"text-gray-700 hover:bg-gray-100"}`,children:["üìä ",t("Dashboard")]}),e.jsxs(c,{href:"/admin/users",className:`px-4 py-2 rounded-xl font-bold text-sm transition-all ${window.location.pathname.startsWith("/admin/users")?"bg-oflem-terracotta text-white":"text-gray-700 hover:bg-gray-100"}`,children:["üë• ",t("Users")]}),e.jsxs(c,{href:"/admin/withdrawals",className:`px-4 py-2 rounded-xl font-bold text-sm transition-all ${window.location.pathname.startsWith("/admin/withdrawals")?"bg-oflem-terracotta text-white":"text-gray-700 hover:bg-gray-100"}`,children:["üí∞ ",t("Withdrawals")]}),e.jsxs(c,{href:"/admin/missions",className:`px-4 py-2 rounded-xl font-bold text-sm transition-all ${window.location.pathname.startsWith("/admin/missions")?"bg-oflem-terracotta text-white":"text-gray-700 hover:bg-gray-100"}`,children:["üìã ",t("Missions")]})]}):e.jsxs("div",{className:"hidden lg:flex items-center gap-8",children:[e.jsx(c,{href:route("providers.index"),className:"text-sm font-bold text-gray-muted hover:text-oflem-charcoal transition-colors",children:t("Find Helpers")}),e.jsx(c,{href:"/#how-it-works",className:"text-sm font-bold text-gray-muted hover:text-oflem-charcoal transition-colors",children:t("How it works")}),r==="performer"&&e.jsx(c,{href:route("dashboard"),className:"text-sm font-bold text-gray-muted hover:text-oflem-charcoal transition-colors",children:t("My Work")})]})]}),e.jsxs("div",{className:"flex items-center gap-3 md:gap-6",children:[e.jsx("div",{className:"hidden sm:block",children:e.jsx(O,{})}),s.user?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(te,{}),e.jsxs(c,{href:route("messages"),className:"p-2 text-gray-muted hover:text-oflem-charcoal transition-colors relative",title:t("Messages"),children:[e.jsx("span",{className:"text-xl",children:"‚úâÔ∏è"}),s.unread_notifications_count>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-oflem-terracotta text-white text-[10px] font-black rounded-full flex items-center justify-center",children:s.unread_notifications_count})]}),e.jsxs(c,{href:s.user.role_type==="customer"?route("wallet.client"):route("wallet.index"),className:"flex items-center gap-2 group",title:t("Wallet"),children:[e.jsxs("div",{className:"flex flex-col items-end hidden md:flex",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-muted uppercase tracking-widest leading-none mb-1",children:t("Wallet")}),e.jsx("span",{className:"text-sm font-black text-oflem-charcoal group-hover:text-oflem-terracotta transition-colors leading-none",children:s.user.role_type==="customer"?t("Spending"):`CHF ${parseFloat(s.user.balance||0).toFixed(2)}`})]}),e.jsx("span",{className:"text-xl p-2 bg-white rounded-xl border border-gray-border shadow-sm group-hover:border-oflem-terracotta transition-all",children:"üí∞"})]}),s.user.admin_role&&e.jsxs(c,{href:n?route("dashboard"):"/admin/dashboard",className:`flex items-center gap-2 px-4 py-2 rounded-xl font-bold transition-all ${n?"bg-gray-700 text-white hover:bg-gray-800":"bg-oflem-terracotta text-white hover:bg-opacity-90"}`,children:[e.jsx("span",{children:n?"üè†":"üîê"}),e.jsx("span",{className:"hidden lg:block",children:t(n?"Exit Admin":"Admin Panel")})]}),!n&&e.jsx(c,{href:route("dashboard"),className:"hidden lg:block text-sm font-black text-oflem-charcoal hover:text-oflem-terracotta transition-colors ml-2",children:t("Dashboard")})]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{href:route("login"),className:"hidden sm:block text-xs md:text-sm font-black text-oflem-charcoal hover:text-oflem-terracotta transition-colors px-2",children:t("Log in")}),e.jsx(c,{href:route("register"),className:"bg-oflem-terracotta hover:bg-opacity-90 text-white px-3 md:px-6 py-2 md:py-2.5 rounded-xl font-black text-xs md:text-sm transition-all shadow-sm hover:shadow-md",children:t("Sign up")})]})]})]})}function le(){const{t}=M();return e.jsxs("footer",{className:"w-full bg-oflem-cream border-t border-gray-border py-16 px-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto grid grid-cols-2 md:grid-cols-4 gap-12",children:[e.jsxs("div",{className:"col-span-2 md:col-span-1",children:[e.jsx("h3",{className:"text-xl font-black text-oflem-charcoal mb-6",children:"Oflem"}),e.jsx("p",{className:"text-gray-muted text-sm font-bold max-w-xs leading-relaxed",children:t("Oflem: the Swiss mutual aid platform for lazy people and the motivated")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-black text-oflem-charcoal uppercase tracking-widest mb-6",children:t("Oflem")}),e.jsxs("ul",{className:"space-y-4",children:[e.jsx("li",{children:e.jsx(c,{href:"#",className:"text-sm font-bold text-gray-muted hover:text-oflem-charcoal transition-colors",children:t("About")})}),e.jsx("li",{children:e.jsx(c,{href:"#",className:"text-sm font-bold text-gray-muted hover:text-oflem-charcoal transition-colors",children:t("How it works")})}),e.jsx("li",{children:e.jsx(c,{href:"#",className:"text-sm font-bold text-gray-muted hover:text-oflem-charcoal transition-colors",children:t("Security & trust")})}),e.jsx("li",{children:e.jsx(c,{href:"#",className:"text-sm font-bold text-gray-muted hover:text-oflem-charcoal transition-colors",children:t("FAQ")})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-black text-oflem-charcoal uppercase tracking-widest mb-6",children:t("Get in Touch")}),e.jsx("ul",{className:"space-y-4",children:e.jsx("li",{children:e.jsx("a",{href:"mailto:hello@oflem.com",className:"text-sm font-bold text-gray-muted hover:text-oflem-charcoal transition-colors",children:"hello@oflem.com"})})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-black text-oflem-charcoal uppercase tracking-widest mb-6",children:t("Terms")}),e.jsxs("ul",{className:"space-y-4",children:[e.jsx("li",{children:e.jsx(c,{href:"#",className:"text-sm font-bold text-gray-muted hover:text-oflem-charcoal transition-colors",children:t("Privacy")})}),e.jsx("li",{children:e.jsx(c,{href:"#",className:"text-sm font-bold text-gray-muted hover:text-oflem-charcoal transition-colors",children:t("Terms")})})]})]})]}),e.jsxs("div",{className:"max-w-7xl mx-auto mt-16 pt-8 border-t border-gray-border flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("p",{className:"text-[10px] font-bold text-gray-muted uppercase tracking-widest",children:["¬© ",new Date().getFullYear()," OFLEM. ALL RIGHTS RESERVED."]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsx("span",{className:"text-[10px] font-bold text-oflem-charcoal uppercase tracking-widest cursor-pointer",children:"EN"}),e.jsx("span",{className:"text-[10px] font-bold text-gray-muted uppercase tracking-widest cursor-pointer",children:"FR"})]})]})]})}export{le as F,ie as H};
